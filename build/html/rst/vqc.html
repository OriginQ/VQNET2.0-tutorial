

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>变分量子线路自动微分模拟 &mdash; VQNET v2.15.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/documentation_options.js?v=a149e6fc"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="量子大模型微调示例" href="llm.html" />
    <link rel="prev" title="使用pyQPanda3量子机器学习模块" href="qnn_pq3.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            VQNET
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">安装介绍</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">VQNet 安装步骤</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">上手实例</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="vqc_demo.html">使用自动微分模拟的量子机器学习示例</a></li>
<li class="toctree-l1"><a class="reference internal" href="qml_demo.html">使用pyQPanda2的量子机器学习示例</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">经典神经网络接口介绍</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="QTensor.html">QTensor 模块</a></li>
<li class="toctree-l1"><a class="reference internal" href="nn.html">经典神经网络模块</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">实用函数</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">使用pyqpanda的量子神经网络接口</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="qnn.html">使用pyQPanda2量子机器学习模块</a></li>
<li class="toctree-l1"><a class="reference internal" href="qnn_pq3.html">使用pyQPanda3量子机器学习模块</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">量子神经网络自动微分模拟接口</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">变分量子线路自动微分模拟</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">模拟器</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#qmachine">QMachine</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.QMachine"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.QMachine</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id3">量子逻辑门接口</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#i">i</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.i"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.i()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id4">I</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.I"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.I</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hadamard">hadamard</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.hadamard"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.hadamard()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id5">Hadamard</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.Hadamard"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.Hadamard</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#t">t</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.t"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.t()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id6">T</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.T"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.T</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#s">s</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.s"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.s()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id7">S</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.S"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.S</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#paulix">paulix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.paulix"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.paulix()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id8">PauliX</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.PauliX"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.PauliX</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pauliy">pauliy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.pauliy"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.pauliy()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id9">PauliY</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.PauliY"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.PauliY</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pauliz">pauliz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.pauliz"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.pauliz()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id10">PauliZ</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.PauliZ"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.PauliZ</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#x1">x1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.x1"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.x1()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id11">X1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.X1"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.X1</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rx">rx</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.rx"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.rx()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id12">RX</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.RX"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.RX</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ry">ry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.ry"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.ry()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id13">RY</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.RY"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.RY</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rz">rz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.rz"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.rz()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id14">RZ</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.RZ"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.RZ</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#crx">crx</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.crx"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.crx()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id15">CRX</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.CRX"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.CRX</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cry">cry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.cry"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.cry()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id16">CRY</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.CRY"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.CRY</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#crz">crz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.crz"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.crz()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id17">CRZ</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.CRZ"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.CRZ</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#u1">u1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.u1"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.u1()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id18">U1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.U1"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.U1</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#u2">u2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.u2"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.u2()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id19">U2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.U2"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.U2</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#u3">u3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.u3"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.u3()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id20">U3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.U3"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.U3</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cy">cy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.cy"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.cy()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id21">CY</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.CY"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.CY</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cnot">cnot</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.cnot"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.cnot()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id22">CNOT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.CNOT"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.CNOT</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cr">cr</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.cr"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.cr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id23">CR</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.CR"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.CR</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#swap">swap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.swap"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.swap()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id24">SWAP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.SWAP"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.SWAP</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cswap">cswap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.cswap"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.cswap()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id25">CSWAP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.CSWAP"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.CSWAP</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#iswap">iswap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.iswap"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.iswap()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cz">cz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.cz"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.cz()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id26">CZ</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.CZ"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.CZ</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rxx">rxx</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.rxx"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.rxx()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id27">RXX</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.RXX"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.RXX</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ryy">ryy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.ryy"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.ryy()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id28">RYY</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.RYY"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.RYY</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rzz">rzz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.rzz"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.rzz()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id29">RZZ</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.RZZ"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.RZZ</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rzx">rzx</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.rzx"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.rzx()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id30">RZX</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.RZX"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.RZX</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#toffoli">toffoli</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.toffoli"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.toffoli()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id31">Toffoli</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.Toffoli"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.Toffoli</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#isingxx">isingxx</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.isingxx"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.isingxx()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id32">IsingXX</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.IsingXX"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.IsingXX</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#isingyy">isingyy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.isingyy"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.isingyy()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id33">IsingYY</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.IsingYY"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.IsingYY</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#isingzz">isingzz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.isingzz"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.isingzz()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id34">IsingZZ</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.IsingZZ"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.IsingZZ</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#isingxy">isingxy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.isingxy"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.isingxy()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id35">IsingXY</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.IsingXY"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.IsingXY</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#phaseshift">phaseshift</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.phaseshift"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.phaseshift()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id36">PhaseShift</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.PhaseShift"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.PhaseShift</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#multirz">multirz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.multirz"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.multirz()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id37">MultiRZ</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.MultiRZ"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.MultiRZ</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#sdg">sdg</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.sdg"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.sdg()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id38">SDG</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.SDG"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.SDG</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tdg">tdg</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.tdg"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.tdg()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id39">TDG</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.TDG"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.TDG</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#controlledphaseshift">controlledphaseshift</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.controlledphaseshift"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.controlledphaseshift()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id40">ControlledPhaseShift</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.ControlledPhaseShift"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.ControlledPhaseShift</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#multicontrolledx">multicontrolledx</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.multicontrolledx"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.multicontrolledx()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id41">MultiControlledX</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.MultiControlledX"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.MultiControlledX</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#single-excitation">single_excitation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.single_excitation"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.single_excitation()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#double-excitation">double_excitation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.double_excitation"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.double_excitation()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id42">测量接口</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#vqc-purity">VQC_Purity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_Purity"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_Purity()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-varmeasure">VQC_VarMeasure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_VarMeasure"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_VarMeasure()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-densitymatrixfromqstate">VQC_DensityMatrixFromQstate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_DensityMatrixFromQstate"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_DensityMatrixFromQstate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#probability">Probability</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.Probability"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.Probability</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#measureall">MeasureAll</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.MeasureAll"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.MeasureAll</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#samples">Samples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.Samples"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.Samples</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#sparsehamiltonian">SparseHamiltonian</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.SparseHamiltonian"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.SparseHamiltonian</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hermitianexpval">HermitianExpval</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.HermitianExpval"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.HermitianExpval</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id43">常用量子变分线路模板</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#vqc-hardwareefficientansatz">VQC_HardwareEfficientAnsatz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_HardwareEfficientAnsatz"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_HardwareEfficientAnsatz</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-basicentanglertemplate">VQC_BasicEntanglerTemplate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_BasicEntanglerTemplate"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_BasicEntanglerTemplate</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-stronglyentanglingtemplate">VQC_StronglyEntanglingTemplate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_StronglyEntanglingTemplate"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_StronglyEntanglingTemplate</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-quantumembedding">VQC_QuantumEmbedding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_QuantumEmbedding"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_QuantumEmbedding</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#expressiveentanglingansatz">ExpressiveEntanglingAnsatz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.ExpressiveEntanglingAnsatz"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.ExpressiveEntanglingAnsatz</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-basisembedding">VQC_BasisEmbedding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_BasisEmbedding"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_BasisEmbedding()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-angleembedding">VQC_AngleEmbedding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_AngleEmbedding"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_AngleEmbedding()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-amplitudeembedding">VQC_AmplitudeEmbedding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_AmplitudeEmbeddingCircuit"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_AmplitudeEmbeddingCircuit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-iqpembedding">VQC_IQPEmbedding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_IQPEmbedding"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_IQPEmbedding()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-rotcircuit">VQC_RotCircuit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_RotCircuit"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_RotCircuit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-crotcircuit">VQC_CRotCircuit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_CRotCircuit"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_CRotCircuit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-controlled-hadamard">VQC_Controlled_Hadamard</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_Controlled_Hadamard"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_Controlled_Hadamard()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-ccz">VQC_CCZ</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_CCZ"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_CCZ()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-fermionicsingleexcitation">VQC_FermionicSingleExcitation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_FermionicSingleExcitation"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_FermionicSingleExcitation()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-fermionicdoubleexcitation">VQC_FermionicDoubleExcitation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_FermionicDoubleExcitation"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_FermionicDoubleExcitation()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-uccsd">VQC_UCCSD</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_UCCSD"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_UCCSD()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-zfeaturemap">VQC_ZFeatureMap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_ZFeatureMap"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_ZFeatureMap()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-zzfeaturemap">VQC_ZZFeatureMap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_ZZFeatureMap"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_ZZFeatureMap()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-allsinglesdoubles">VQC_AllSinglesDoubles</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_AllSinglesDoubles"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_AllSinglesDoubles()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-basisrotation">VQC_BasisRotation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_BasisRotation"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_BasisRotation()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-quantumpoolingcircuit">VQC_QuantumPoolingCircuit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_QuantumPoolingCircuit"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_QuantumPoolingCircuit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-qft-add-to-register">vqc_qft_add_to_register</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.vqc_qft_add_to_register"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.vqc_qft_add_to_register()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-qft-add-two-register">vqc_qft_add_two_register</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vqc_qft_add_two_register"><code class="docutils literal notranslate"><span class="pre">vqc_qft_add_two_register()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-qft-mul">vqc_qft_mul</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vqc_qft_mul"><code class="docutils literal notranslate"><span class="pre">vqc_qft_mul()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-fable">VQC_FABLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_FABLE"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_FABLE</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-lcu">VQC_LCU</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_LCU"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_LCU</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-qsvt">VQC_QSVT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.VQC_QSVT"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.VQC_QSVT</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id45">量子机器学习模型接口</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#quanvolution">Quanvolution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.qcnn.Quanvolution"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.qcnn.Quanvolution</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#qdrl">QDRL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.qdrl_vqc.QDRL"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.qdrl_vqc.QDRL</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#qgru">QGRU</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.qgru.QGRU"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.qgru.QGRU</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#qlinear">QLinear</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.qlinear.QLinear"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.qlinear.QLinear</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#qlstm">QLSTM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.qlstm.QLSTM"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.qlstm.QLSTM</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#qmlpmodel">QMLPModel</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.qmlp.qmlp.QMLPModel"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.qmlp.qmlp.QMLPModel</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#qrlmodel">QRLModel</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.qrl.QRLModel"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.qrl.QRLModel</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#qrnn">QRNN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.qrnn.QRNN"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.qrnn.QRNN</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ttolayer">TTOLayer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.ttolayer.TTOLayer"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.ttolayer.TTOLayer</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id46">其他函数</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#quantumlayeradjoint">QuantumLayerAdjoint</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.QuantumLayerAdjoint"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.QuantumLayerAdjoint</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#quantumlayeres">QuantumLayerES</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.QuantumLayerES"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.QuantumLayerES</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dataparallelvqcadjointlayer">DataParallelVQCAdjointLayer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.distributed.DataParallelVQCAdjointLayer"><code class="docutils literal notranslate"><span class="pre">pyvqnet.distributed.DataParallelVQCAdjointLayer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dataparallelvqclayer">DataParallelVQCLayer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.distributed.DataParallelVQCLayer"><code class="docutils literal notranslate"><span class="pre">pyvqnet.distributed.DataParallelVQCLayer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vqc-to-originir-list">vqc_to_originir_list</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.vqc_to_originir_list"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.vqc_to_originir_list()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#originir-to-vqc">originir_to_vqc</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.originir_to_vqc"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.originir_to_vqc()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#model-summary">model_summary</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.model_summary"><code class="docutils literal notranslate"><span class="pre">pyvqnet.model_summary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#qng">QNG</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.qng.QNG"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.qng.QNG</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wrapper-single-qubit-op-fuse">wrapper_single_qubit_op_fuse</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.wrapper_single_qubit_op_fuse"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.wrapper_single_qubit_op_fuse()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wrapper-commute-controlled">wrapper_commute_controlled</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.wrapper_commute_controlled"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.wrapper_commute_controlled()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wrapper-merge-rotations">wrapper_merge_rotations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.wrapper_merge_rotations"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.wrapper_merge_rotations()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wrapper-compile">wrapper_compile</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyvqnet.qnn.vqc.wrapper_compile"><code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.wrapper_compile()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">量子大模型微调</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="llm.html">量子大模型微调示例</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">其他</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="torch_api.html">VQNet使用torch进行底层计算</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">常见问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">VQNet Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VQNET</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">变分量子线路自动微分模拟</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/rst/vqc.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="vqc-api">
<span id="id1"></span><h1>变分量子线路自动微分模拟<a class="headerlink" href="#vqc-api" title="Link to this heading">¶</a></h1>
<p>VQNet基于自动微分算子构建以及一些常用量子逻辑门、量子线路以及测量方法,可使用自动微分模拟代替量子线路parameter-shift方法计算梯度。我们可以像其他 <cite>Module</cite> 一样,使用VQC算子构成复杂神经网络。在 <cite>Module</cite> 中需要定义虚拟机 <cite>QMachine</cite>,并且需要对machine中 <cite>states</cite> 根据输入的batchsize进行reset_states。请具体看下例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.nn</span><span class="w"> </span><span class="kn">import</span> <span class="n">Module</span><span class="p">,</span><span class="n">Linear</span><span class="p">,</span><span class="n">ModuleList</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc.qcircuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_HardwareEfficientAnsatz</span><span class="p">,</span><span class="n">RZZ</span><span class="p">,</span><span class="n">RZ</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Probability</span><span class="p">,</span><span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>

<span class="k">class</span><span class="w"> </span><span class="nc">QM</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linearx</span> <span class="o">=</span> <span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ansatz</span> <span class="o">=</span> <span class="n">VQC_HardwareEfficientAnsatz</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;rx&quot;</span><span class="p">,</span> <span class="s2">&quot;RY&quot;</span><span class="p">,</span> <span class="s2">&quot;rz&quot;</span><span class="p">],</span>
                                    <span class="n">entangle_gate</span><span class="o">=</span><span class="s2">&quot;cnot&quot;</span><span class="p">,</span>
                                    <span class="n">entangle_rules</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
                                    <span class="n">depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1">#基于VQC的RZ 在0比特上</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encode1</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1">#基于VQC的RZ 在1比特上</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encode2</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1">#基于VQC的概率测量 在0,2比特上</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">Probability</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
        <span class="c1">#量子设备QMachine,使用4个比特。</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1">#必须要将states reset到与输入一样的batchsize。</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearx</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="c1">#将输入编码到RZ门上,注意输入必须是 [batchsize,1]的shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encode1</span><span class="p">(</span><span class="n">params</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span><span class="n">q_machine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,)</span>
        <span class="c1">#将输入编码到RZ门上,注意输入必须是 [batchsize,1]的shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encode2</span><span class="p">(</span><span class="n">params</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">q_machine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ansatz</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

<span class="n">bz</span> <span class="o">=</span><span class="mi">3</span>
<span class="n">inputx</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="n">bz</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">bz</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">inputx</span><span class="o">.</span><span class="n">requires_grad</span><span class="o">=</span> <span class="kc">True</span>
<span class="c1">#像其他Module一样定义</span>
<span class="n">qlayer</span> <span class="o">=</span> <span class="n">QM</span><span class="p">()</span>
<span class="c1">#前传</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">qlayer</span><span class="p">(</span><span class="n">inputx</span><span class="p">)</span>
<span class="c1">#反传</span>
<span class="n">y</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>如果要使用一些带训练参数的变分量子线路逻辑门,而不止像上例一样将数据编码到线路上,可以参考下面例子:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.nn</span><span class="w"> </span><span class="kn">import</span> <span class="n">Module</span><span class="p">,</span><span class="n">Linear</span><span class="p">,</span><span class="n">ModuleList</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc.qcircuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_HardwareEfficientAnsatz</span><span class="p">,</span><span class="n">RZZ</span><span class="p">,</span><span class="n">RZ</span><span class="p">,</span><span class="n">rz</span><span class="p">,</span><span class="n">ry</span><span class="p">,</span><span class="n">cnot</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Probability</span><span class="p">,</span><span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>

<span class="k">class</span><span class="w"> </span><span class="nc">QM</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linearx</span> <span class="o">=</span> <span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ansatz</span> <span class="o">=</span> <span class="n">VQC_HardwareEfficientAnsatz</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;rx&quot;</span><span class="p">,</span> <span class="s2">&quot;RY&quot;</span><span class="p">,</span> <span class="s2">&quot;rz&quot;</span><span class="p">],</span>
                                    <span class="n">entangle_gate</span><span class="o">=</span><span class="s2">&quot;cnot&quot;</span><span class="p">,</span>
                                    <span class="n">entangle_rules</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
                                    <span class="n">depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1">#基于VQC的RZ 在0比特上</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encode1</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1">#基于VQC的RZ 在1比特上</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encode2</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1">#设置RZ 有要训练参数has_params = True,需要训练trainable= True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vqc</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">has_params</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span><span class="n">trainable</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1">#基于VQC的概率测量 在0,2比特上</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">Probability</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
        <span class="c1">#量子设备QMachine,使用4个比特。</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1">#必须要将states reset到与输入一样的batchsize。</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearx</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="c1">#将输入编码到RZ门上,注意输入必须是 [batchsize,1]的shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encode1</span><span class="p">(</span><span class="n">params</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span><span class="n">q_machine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,)</span>
        <span class="c1">#将输入编码到RZ门上,注意输入必须是 [batchsize,1]的shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encode2</span><span class="p">(</span><span class="n">params</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">q_machine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,)</span>
        <span class="c1">#使用RZ门构成的含参变分线路,会加入训练。</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vqc</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ansatz</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

<span class="n">bz</span> <span class="o">=</span><span class="mi">3</span>
<span class="n">inputx</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="n">bz</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">bz</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">inputx</span><span class="o">.</span><span class="n">requires_grad</span><span class="o">=</span> <span class="kc">True</span>
<span class="c1">#像其他Module一样定义</span>
<span class="n">qlayer</span> <span class="o">=</span> <span class="n">QM</span><span class="p">()</span>
<span class="c1">#前传</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">qlayer</span><span class="p">(</span><span class="n">inputx</span><span class="p">)</span>
<span class="c1">#反传</span>
<span class="n">y</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<section id="id2">
<h2>模拟器<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<section id="qmachine">
<h3>QMachine<a class="headerlink" href="#qmachine" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.QMachine">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">QMachine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_ir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.QMachine" title="Link to this definition">¶</a></dt>
<dd><p>变分量子计算的模拟器类,包含states属性为量子线路的statevectors。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>在每次运行一个完整的量子线路之前,必须使用 <cite>pyvqnet.qnn.vqc.QMachine.reset_states(batchsize)</cite> 将模拟器里面初态重新初始化,并且广播为
(batchsize,*) 维度从而适应批量数据训练。</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_wires</strong> – 量子比特数。</p></li>
<li><p><strong>dtype</strong> – 计算数据的数据类型。默认值是pyvqnet。kcomplex64,对应的参数精度为pyvqnet.kfloat32。</p></li>
<li><p><strong>grad_mode</strong> – 梯度计算模式,可为 “adjoint”,默认值:””,使用自动微分模拟。</p></li>
<li><p><strong>save_ir</strong> – 设置为True时,将操作保存到originIR,默认值:False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>输出QMachine。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>

<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>


<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>

<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.QMachine.reset_states">
<span class="sig-name descname"><span class="pre">reset_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batchsize</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.QMachine.reset_states" title="Link to this definition">¶</a></dt>
<dd><p>将模拟器里面初态重新初始化,并且广播为
(batchsize,[2]**num_qubits) 维度从而使得模拟器可以进行批量数据的模型计算。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batchsize</strong> – 批处理的数量。</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="id3">
<h2>量子逻辑门接口<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h2>
<section id="i">
<h3>i<a class="headerlink" href="#i" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.i">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.i" title="Link to this definition">¶</a></dt>
<dd><p>对 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code> 中的态矢(statevectors)作用量子逻辑门 I 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">i</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">i</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>

<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>


<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>

<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id4">
<h3>I<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.I">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">I</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.I" title="Link to this definition">¶</a></dt>
<dd><p>定义一个I逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个I逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">I</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">I</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="hadamard">
<h3>hadamard<a class="headerlink" href="#hadamard" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.hadamard">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">hadamard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.hadamard" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 hadamard 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">hadamard</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">hadamard</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
<span class="c1"># [[[[[0.7071068+0.j 0.       +0.j]</span>
<span class="c1">#     [0.       +0.j 0.       +0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.7071068+0.j 0.       +0.j]</span>
<span class="c1">#     [0.       +0.j 0.       +0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.       +0.j 0.       +0.j]</span>
<span class="c1">#     [0.       +0.j 0.       +0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j 0.       +0.j]</span>
<span class="c1">#     [0.       +0.j 0.       +0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id5">
<h3>Hadamard<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.Hadamard">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">Hadamard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.Hadamard" title="Link to this definition">¶</a></dt>
<dd><p>定义一个Hadamard逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 Hadamard逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Hadamard</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">Hadamard</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="t">
<h3>t<a class="headerlink" href="#t" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.t">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.t" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 t 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">t</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">t</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id6">
<h3>T<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.T">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">T</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.T" title="Link to this definition">¶</a></dt>
<dd><p>定义一个T逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 T逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">T</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">T</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="s">
<h3>s<a class="headerlink" href="#s" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.s">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.s" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 s 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">s</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">s</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id7">
<h3>S<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.S">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">S</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.S" title="Link to this definition">¶</a></dt>
<dd><p>定义一个S逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 S逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">S</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="paulix">
<h3>paulix<a class="headerlink" href="#paulix" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.paulix">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">paulix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.paulix" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 paulix 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">paulix</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">paulix</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id8">
<h3>PauliX<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.PauliX">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">PauliX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.PauliX" title="Link to this definition">¶</a></dt>
<dd><p>定义一个PauliX逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 PauliX逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">PauliX</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">PauliX</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="pauliy">
<h3>pauliy<a class="headerlink" href="#pauliy" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.pauliy">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">pauliy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.pauliy" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 pauliy 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">pauliy</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">pauliy</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+1.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id9">
<h3>PauliY<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.PauliY">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">PauliY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.PauliY" title="Link to this definition">¶</a></dt>
<dd><p>定义一个PauliY逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 PauliY逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">PauliY</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">PauliY</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="pauliz">
<h3>pauliz<a class="headerlink" href="#pauliz" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.pauliz">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">pauliz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.pauliz" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 pauliz 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">pauliz</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">pauliz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id10">
<h3>PauliZ<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.PauliZ">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">PauliZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.PauliZ" title="Link to this definition">¶</a></dt>
<dd><p>定义一个PauliZ逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 PauliZ逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">PauliZ</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">PauliZ</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="x1">
<h3>x1<a class="headerlink" href="#x1" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.x1">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">x1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.x1" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 x1 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">x1</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">x1</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[0.7071068+0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       -0.7071068j 0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.       +0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id11">
<h3>X1<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.X1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">X1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.X1" title="Link to this definition">¶</a></dt>
<dd><p>定义一个X1逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 X1逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">X1</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">X1</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="rx">
<h3>rx<a class="headerlink" href="#rx" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.rx">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">rx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.rx" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 rx</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">rx</span><span class="p">,</span><span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">rx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[0.9689124+0.j       0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       -0.247404j 0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.       +0.j       0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j       0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id12">
<h3>RX<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.RX">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">RX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.RX" title="Link to this definition">¶</a></dt>
<dd><p>定义一个RX逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 RX逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">RX</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">RX</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="ry">
<h3>ry<a class="headerlink" href="#ry" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.ry">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">ry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.ry" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 ry 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ry</span><span class="p">,</span><span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[0.9689124+0.j 0.       +0.j]</span>
<span class="c1">#     [0.       +0.j 0.       +0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.247404 +0.j 0.       +0.j]</span>
<span class="c1">#     [0.       +0.j 0.       +0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.       +0.j 0.       +0.j]</span>
<span class="c1">#     [0.       +0.j 0.       +0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j 0.       +0.j]</span>
<span class="c1">#     [0.       +0.j 0.       +0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id13">
<h3>RY<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.RY">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">RY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.RY" title="Link to this definition">¶</a></dt>
<dd><p>定义一个RY逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 RY逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">RY</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">RY</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="rz">
<h3>rz<a class="headerlink" href="#rz" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.rz">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">rz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.rz" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 rz 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">rz</span><span class="p">,</span><span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">rz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[0.9689124-0.247404j 0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j       0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.       +0.j       0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j       0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id14">
<h3>RZ<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.RZ">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">RZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.RZ" title="Link to this definition">¶</a></dt>
<dd><p>定义一个RZ逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 RZ逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">RZ</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="crx">
<h3>crx<a class="headerlink" href="#crx" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.crx">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">crx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.crx" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 crx 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vqc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">crx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id15">
<h3>CRX<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.CRX">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">CRX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.CRX" title="Link to this definition">¶</a></dt>
<dd><p>定义一个CRX逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 CRX逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">CRX</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">CRX</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="cry">
<h3>cry<a class="headerlink" href="#cry" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.cry">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">cry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.cry" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 cry 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vqc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">cry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id16">
<h3>CRY<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.CRY">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">CRY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.CRY" title="Link to this definition">¶</a></dt>
<dd><p>定义一个CRY逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 CRY逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">CRY</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">CRY</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="crz">
<h3>crz<a class="headerlink" href="#crz" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.crz">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">crz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.crz" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 crz 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vqc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">crz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id17">
<h3>CRZ<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.CRZ">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">CRZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.CRZ" title="Link to this definition">¶</a></dt>
<dd><p>定义一个CRZ逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 CRZ逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">CRZ</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">CRZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="u1">
<h3>u1<a class="headerlink" href="#u1" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.u1">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">u1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.u1" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 u1 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">u1</span><span class="p">,</span><span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">u1</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">24.0</span><span class="p">]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id18">
<h3>U1<a class="headerlink" href="#id18" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.U1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">U1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.U1" title="Link to this definition">¶</a></dt>
<dd><p>定义一个U1逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 U1逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">U1</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">U1</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="u2">
<h3>u2<a class="headerlink" href="#u2" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.u2">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">u2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.u2" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 u2 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">u2</span><span class="p">,</span><span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">u2</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([[</span><span class="mf">24.0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">]]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[0.7071068+0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.2999398-0.6403406j 0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.       +0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id19">
<h3>U2<a class="headerlink" href="#id19" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.U2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">U2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.U2" title="Link to this definition">¶</a></dt>
<dd><p>定义一个U2逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 U2逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">U2</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">U2</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="u3">
<h3>u3<a class="headerlink" href="#u3" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.u3">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">u3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.u3" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 u3 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">u3</span><span class="p">,</span><span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">u3</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([[</span><span class="mf">24.0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[0.843854 +0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.5312032+0.0757212j 0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.       +0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id20">
<h3>U3<a class="headerlink" href="#id20" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.U3">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">U3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.U3" title="Link to this definition">¶</a></dt>
<dd><p>定义一个U3逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 U3逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">U3</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">U3</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="cy">
<h3>cy<a class="headerlink" href="#cy" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.cy">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">cy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.cy" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 cy 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">cy</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">cy</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
<span class="c1"># [[[[[1.+0.j,0.+0.j],</span>
<span class="c1">#     [0.+0.j,0.+0.j]],</span>

<span class="c1">#    [[0.+0.j,0.+0.j],</span>
<span class="c1">#     [0.+0.j,0.+0.j]]],</span>


<span class="c1">#   [[[0.+0.j,0.+0.j],</span>
<span class="c1">#     [0.+0.j,0.+0.j]],</span>

<span class="c1">#    [[0.+0.j,0.+0.j],</span>
<span class="c1">#     [0.+0.j,0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id21">
<h3>CY<a class="headerlink" href="#id21" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.CY">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">CY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.CY" title="Link to this definition">¶</a></dt>
<dd><p>定义一个CY逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 CY逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">CY</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">CY</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="cnot">
<h3>cnot<a class="headerlink" href="#cnot" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.cnot">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">cnot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.cnot" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 cnot 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">cnot</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id22">
<h3>CNOT<a class="headerlink" href="#id22" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.CNOT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">CNOT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.CNOT" title="Link to this definition">¶</a></dt>
<dd><p>定义一个CNOT逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 CNOT逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">CNOT</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">CNOT</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="cr">
<h3>cr<a class="headerlink" href="#cr" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.cr">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">cr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.cr" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 cr 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">cr</span><span class="p">,</span><span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">cr</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id23">
<h3>CR<a class="headerlink" href="#id23" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.CR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">CR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.CR" title="Link to this definition">¶</a></dt>
<dd><p>定义一个CR逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 CR逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">CR</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">CR</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="swap">
<h3>swap<a class="headerlink" href="#swap" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.swap">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">swap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.swap" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 swap 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">swap</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">swap</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id24">
<h3>SWAP<a class="headerlink" href="#id24" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.SWAP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">SWAP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.SWAP" title="Link to this definition">¶</a></dt>
<dd><p>定义一个SWAP逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 SWAP 逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">SWAP</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">SWAP</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="cswap">
<h3>cswap<a class="headerlink" href="#cswap" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.cswap">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">cswap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.cswap" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 cswap 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">cswap</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">cswap</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
<span class="c1"># [[[[[1.+0.j,0.+0.j],</span>
<span class="c1">#     [0.+0.j,0.+0.j]],</span>

<span class="c1">#    [[0.+0.j,0.+0.j],</span>
<span class="c1">#     [0.+0.j,0.+0.j]]],</span>


<span class="c1">#   [[[0.+0.j,0.+0.j],</span>
<span class="c1">#     [0.+0.j,0.+0.j]],</span>

<span class="c1">#    [[0.+0.j,0.+0.j],</span>
<span class="c1">#     [0.+0.j,0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id25">
<h3>CSWAP<a class="headerlink" href="#id25" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.CSWAP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">CSWAP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.CSWAP" title="Link to this definition">¶</a></dt>
<dd><p>定义一个SWAP逻辑门类 。</p>
<div class="math notranslate nohighlight">
\[\begin{split}CSWAP = \begin{bmatrix}
    1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 CSWAP 逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">CSWAP</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">CSWAP</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
<span class="c1"># [[[[[1.+0.j,0.+0.j],</span>
<span class="c1">#     [0.+0.j,0.+0.j]],</span>

<span class="c1">#    [[0.+0.j,0.+0.j],</span>
<span class="c1">#     [0.+0.j,0.+0.j]]],</span>


<span class="c1">#   [[[0.+0.j,0.+0.j],</span>
<span class="c1">#     [0.+0.j,0.+0.j]],</span>

<span class="c1">#    [[0.+0.j,0.+0.j],</span>
<span class="c1">#     [0.+0.j,0.+0.j]]]],</span>



<span class="c1">#  [[[[1.+0.j,0.+0.j],</span>
<span class="c1">#     [0.+0.j,0.+0.j]],</span>

<span class="c1">#    [[0.+0.j,0.+0.j],</span>
<span class="c1">#     [0.+0.j,0.+0.j]]],</span>


<span class="c1">#   [[[0.+0.j,0.+0.j],</span>
<span class="c1">#     [0.+0.j,0.+0.j]],</span>

<span class="c1">#    [[0.+0.j,0.+0.j],</span>
<span class="c1">#     [0.+0.j,0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="iswap">
<h3>iswap<a class="headerlink" href="#iswap" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.iswap">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">iswap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.iswap" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 iswap 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vqc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">iswap</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">params</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="cz">
<h3>cz<a class="headerlink" href="#cz" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.cz">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">cz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.cz" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 cz 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">cz</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">cz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id26">
<h3>CZ<a class="headerlink" href="#id26" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.CZ">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">CZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.CZ" title="Link to this definition">¶</a></dt>
<dd><p>定义一个CZ逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 CZ 逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">CZ</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">CZ</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="rxx">
<h3>rxx<a class="headerlink" href="#rxx" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.rxx">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">rxx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.rxx" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 rxx 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">rxx</span><span class="p">,</span><span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">rxx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.2</span><span class="p">]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[0.9950042+0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.       +0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       -0.0998334j 0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id27">
<h3>RXX<a class="headerlink" href="#id27" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.RXX">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">RXX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.RXX" title="Link to this definition">¶</a></dt>
<dd><p>定义一个RXX逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个RXX逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">RXX</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">RXX</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="ryy">
<h3>ryy<a class="headerlink" href="#ryy" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.ryy">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">ryy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.ryy" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 ryy 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ryy</span><span class="p">,</span><span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ryy</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.2</span><span class="p">]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[0.9950042+0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.       +0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.0998334j 0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id28">
<h3>RYY<a class="headerlink" href="#id28" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.RYY">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">RYY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.RYY" title="Link to this definition">¶</a></dt>
<dd><p>定义一个RYY逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 RYY 逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">RYY</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">RYY</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="rzz">
<h3>rzz<a class="headerlink" href="#rzz" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.rzz">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">rzz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.rzz" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 rzz 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">rzz</span><span class="p">,</span><span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">rzz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.2</span><span class="p">]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[0.9950042-0.0998334j 0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.       +0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id29">
<h3>RZZ<a class="headerlink" href="#id29" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.RZZ">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">RZZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.RZZ" title="Link to this definition">¶</a></dt>
<dd><p>定义一个RZZ逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 RZZ 逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">RZZ</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">RZZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="rzx">
<h3>rzx<a class="headerlink" href="#rzx" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.rzx">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">rzx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.rzx" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 RZX 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">rzx</span><span class="p">,</span><span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">rzx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.2</span><span class="p">]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[0.9950042+0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.       -0.0998334j 0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j        0.       +0.j       ]</span>
<span class="c1">#     [0.       +0.j        0.       +0.j       ]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id30">
<h3>RZX<a class="headerlink" href="#id30" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.RZX">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">RZX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.RZX" title="Link to this definition">¶</a></dt>
<dd><p>定义一个RZX逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 RZX 逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">RZX</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">RZX</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="toffoli">
<h3>toffoli<a class="headerlink" href="#toffoli" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.toffoli">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">toffoli</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.toffoli" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 toffoli 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">toffoli</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">toffoli</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id31">
<h3>Toffoli<a class="headerlink" href="#id31" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.Toffoli">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">Toffoli</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.Toffoli" title="Link to this definition">¶</a></dt>
<dd><p>定义一个Toffoli逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 Toffoli 逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Toffoli</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">Toffoli</span><span class="p">(</span>  <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="isingxx">
<h3>isingxx<a class="headerlink" href="#isingxx" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.isingxx">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">isingxx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.isingxx" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 isingxx 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vqc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">isingxx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">params</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[0.9689124+0.j       0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j       0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.       +0.j       0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       -0.247404j 0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id32">
<h3>IsingXX<a class="headerlink" href="#id32" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.IsingXX">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">IsingXX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.IsingXX" title="Link to this definition">¶</a></dt>
<dd><p>定义一个IsingXX逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个IsingXX 逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">IsingXX</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">IsingXX</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="isingyy">
<h3>isingyy<a class="headerlink" href="#isingyy" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.isingyy">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">isingyy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.isingyy" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 isingyy 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vqc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">isingyy</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">params</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[0.9689124+0.j       0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j       0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.       +0.j       0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.247404j 0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id33">
<h3>IsingYY<a class="headerlink" href="#id33" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.IsingYY">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">IsingYY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.IsingYY" title="Link to this definition">¶</a></dt>
<dd><p>定义一个IsingYY逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 IsingYY 逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">IsingYY</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">IsingYY</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="isingzz">
<h3>isingzz<a class="headerlink" href="#isingzz" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.isingzz">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">isingzz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.isingzz" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 isingzz 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vqc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">isingzz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">params</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[0.9689124-0.247404j 0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j       0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.       +0.j       0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j       0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id34">
<h3>IsingZZ<a class="headerlink" href="#id34" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.IsingZZ">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">IsingZZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.IsingZZ" title="Link to this definition">¶</a></dt>
<dd><p>定义一个IsingZZ逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 IsingZZ 逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">IsingZZ</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">IsingZZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="isingxy">
<h3>isingxy<a class="headerlink" href="#isingxy" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.isingxy">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">isingxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.isingxy" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 isingxy 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vqc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">isingxy</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">params</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id35">
<h3>IsingXY<a class="headerlink" href="#id35" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.IsingXY">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">IsingXY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.IsingXY" title="Link to this definition">¶</a></dt>
<dd><p>定义一个IsingXY逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 IsingXY 逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">IsingXY</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">IsingXY</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="phaseshift">
<h3>phaseshift<a class="headerlink" href="#phaseshift" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.phaseshift">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">phaseshift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.phaseshift" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 phaseshift 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vqc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">phaseshift</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">params</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id36">
<h3>PhaseShift<a class="headerlink" href="#id36" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.PhaseShift">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">PhaseShift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.PhaseShift" title="Link to this definition">¶</a></dt>
<dd><p>定义一个PhaseShift逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 PhaseShift 逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">PhaseShift</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">PhaseShift</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="multirz">
<h3>multirz<a class="headerlink" href="#multirz" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.multirz">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">multirz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.multirz" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 multirz 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vqc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">multirz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">params</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[0.9689124-0.247404j 0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j       0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.       +0.j       0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.       +0.j       0.       +0.j      ]</span>
<span class="c1">#     [0.       +0.j       0.       +0.j      ]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id37">
<h3>MultiRZ<a class="headerlink" href="#id37" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.MultiRZ">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">MultiRZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.MultiRZ" title="Link to this definition">¶</a></dt>
<dd><p>定义一个MultiRZ逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 MultiRZ 逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiRZ</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">MultiRZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="sdg">
<h3>sdg<a class="headerlink" href="#sdg" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.sdg">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">sdg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.sdg" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 sdg 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vqc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">sdg</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id38">
<h3>SDG<a class="headerlink" href="#id38" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.SDG">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">SDG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.SDG" title="Link to this definition">¶</a></dt>
<dd><p>定义一个SDG逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个SDG逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">SDG</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">SDG</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="tdg">
<h3>tdg<a class="headerlink" href="#tdg" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.tdg">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">tdg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.tdg" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 tdg 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vqc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">tdg</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id39">
<h3>TDG<a class="headerlink" href="#id39" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.TDG">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">TDG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.TDG" title="Link to this definition">¶</a></dt>
<dd><p>定义一个TDG逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个TDG逻辑门类实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">TDG</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">TDG</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="controlledphaseshift">
<h3>controlledphaseshift<a class="headerlink" href="#controlledphaseshift" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.controlledphaseshift">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">controlledphaseshift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.controlledphaseshift" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 controlledphaseshift 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vqc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">vqc</span><span class="o">.</span><span class="n">hadamard</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">controlledphaseshift</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[0.25     +0.j        0.25     +0.j       ]</span>
<span class="c1">#     [0.25     +0.j        0.25     +0.j       ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.25     +0.j        0.25     +0.j       ]</span>
<span class="c1">#     [0.25     +0.j        0.25     +0.j       ]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.25     +0.j        0.25     +0.j       ]</span>
<span class="c1">#     [0.25     +0.j        0.25     +0.j       ]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.2193956+0.1198564j 0.2193956+0.1198564j]</span>
<span class="c1">#     [0.2193956+0.1198564j 0.2193956+0.1198564j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id40">
<h3>ControlledPhaseShift<a class="headerlink" href="#id40" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.ControlledPhaseShift">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">ControlledPhaseShift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.ControlledPhaseShift" title="Link to this definition">¶</a></dt>
<dd><p>定义一个ControlledPhaseShift逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个ControlledPhaseShift。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ControlledPhaseShift</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">ControlledPhaseShift</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">batchsize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">batchsize</span><span class="p">)</span>
<span class="n">layer</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="multicontrolledx">
<h3>multicontrolledx<a class="headerlink" href="#multicontrolledx" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.multicontrolledx">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">multicontrolledx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">control_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.multicontrolledx" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 multicontrolledx 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
<li><p><strong>control_values</strong> – 控制值,默认为None,当比特位为1时控制。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vqc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">vqc</span><span class="o">.</span><span class="n">hadamard</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">phaseshift</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">params</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]))</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">phaseshift</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">params</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">phaseshift</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">params</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([</span><span class="mi">3</span><span class="p">]))</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">multicontrolledx</span><span class="p">(</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[ 0.25     +0.j       ,-0.2474981+0.03528j  ],</span>
<span class="c1">#     [ 0.25     +0.j       ,-0.2474981+0.03528j  ]],</span>

<span class="c1">#    [[-0.1040367+0.2273243j, 0.0709155-0.239731j ],</span>
<span class="c1">#     [-0.1040367+0.2273243j, 0.0709155-0.239731j ]]],</span>


<span class="c1">#   [[[ 0.2193956+0.1198564j,-0.2341141-0.0876958j],</span>
<span class="c1">#     [ 0.2193956+0.1198564j,-0.2341141-0.0876958j]],</span>

<span class="c1">#    [[-0.2002859+0.149618j , 0.1771674-0.176385j ],</span>
<span class="c1">#     [-0.2002859+0.149618j , 0.1771674-0.176385j ]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id41">
<h3>MultiControlledX<a class="headerlink" href="#id41" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.MultiControlledX">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">MultiControlledX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">has_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pyvqnet.kcomplex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">control_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.MultiControlledX" title="Link to this definition">¶</a></dt>
<dd><p>定义一个MultiControlledX逻辑门类 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_params</strong> – 是否具有参数,例如RX,RY等门需要设置为True,不含参数的需要设置为False,默认为False。</p></li>
<li><p><strong>trainable</strong> – 是否自带含待训练参数,如果该层使用外部输入数据构建逻辑门矩阵,设置为False,如果待训练参数需要从该层初始化,则为True,默认为False。</p></li>
<li><p><strong>init_params</strong> – 初始化参数,用来编码经典数据QTensor,默认为None,如果为p个参数的含参逻辑门,入参的数据维度需要为[1,p]或者[p]。</p></li>
<li><p><strong>wires</strong> – 线路作用的比特索引,默认为None。</p></li>
<li><p><strong>dtype</strong> – 逻辑门内部矩阵的数据精度,可以设置为pyvqnet.kcomplex64,或pyvqnet.kcomplex128,分别对应float输入或者double入参。</p></li>
<li><p><strong>use_dagger</strong> – 是否使用该门的转置共轭版本,默认为False。</p></li>
<li><p><strong>control_values</strong> – 控制值,默认为None,当比特位为1时控制。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 MultiControlledX 逻辑门实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vqc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span><span class="p">,</span><span class="n">kcomplex64</span>

<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">kcomplex64</span><span class="p">)</span>
<span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">vqc</span><span class="o">.</span><span class="n">hadamard</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">isingzz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.25</span><span class="p">]),</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">double_excitation</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.55</span><span class="p">]),</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

<span class="n">mcx</span> <span class="o">=</span> <span class="n">vqc</span><span class="o">.</span><span class="n">MultiControlledX</span><span class="p">(</span>
                <span class="n">init_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">dtype</span><span class="o">=</span><span class="n">kcomplex64</span><span class="p">,</span>
                <span class="n">use_dagger</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">control_values</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">mcx</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">qm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">[[[[[0.2480494-0.0311687j,0.2480494-0.0311687j],</span>
<span class="sd">    [0.2480494+0.0311687j,0.1713719-0.0215338j]],</span>

<span class="sd">[[0.2480494+0.0311687j,0.2480494+0.0311687j],</span>
<span class="sd">    [0.2480494-0.0311687j,0.2480494+0.0311687j]]],</span>


<span class="sd">[[[0.2480494+0.0311687j,0.2480494+0.0311687j],</span>
<span class="sd">    [0.2480494+0.0311687j,0.2480494+0.0311687j]],</span>

<span class="sd">[[0.306086 -0.0384613j,0.2480494-0.0311687j],</span>
<span class="sd">    [0.2480494-0.0311687j,0.2480494-0.0311687j]]]],</span>



<span class="sd">[[[[0.2480494-0.0311687j,0.2480494-0.0311687j],</span>
<span class="sd">    [0.2480494+0.0311687j,0.1713719-0.0215338j]],</span>

<span class="sd">[[0.2480494+0.0311687j,0.2480494+0.0311687j],</span>
<span class="sd">    [0.2480494-0.0311687j,0.2480494+0.0311687j]]],</span>


<span class="sd">[[[0.2480494+0.0311687j,0.2480494+0.0311687j],</span>
<span class="sd">    [0.2480494+0.0311687j,0.2480494+0.0311687j]],</span>

<span class="sd">[[0.306086 -0.0384613j,0.2480494-0.0311687j],</span>
<span class="sd">    [0.2480494-0.0311687j,0.2480494-0.0311687j]]]]]</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="single-excitation">
<h3>single_excitation<a class="headerlink" href="#single-excitation" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.single_excitation">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">single_excitation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.single_excitation" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 single_excitation 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vqc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">single_excitation</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[1.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.+0.j 0.+0.j]</span>
<span class="c1">#     [0.+0.j 0.+0.j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="double-excitation">
<h3>double_excitation<a class="headerlink" href="#double-excitation" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.double_excitation">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">double_excitation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dagger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.double_excitation" title="Link to this definition">¶</a></dt>
<dd><p>对q_machine中的态矢作用量子逻辑门 double_excitation 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wires</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 参数矩阵,默认为None,对于含p个参数的逻辑门操作函数,入参的维度需要为[1,p],或[p]。</p></li>
<li><p><strong>use_dagger</strong> – 是否共轭转置,默认为False。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vqc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">vqc</span><span class="o">.</span><span class="n">hadamard</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">isingzz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.55</span><span class="p">]),</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">vqc</span><span class="o">.</span><span class="n">double_excitation</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.55</span><span class="p">]),</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[[0.2406063-0.0678867j 0.2406063-0.0678867j]</span>
<span class="c1">#     [0.2406063-0.0678867j 0.1662296-0.0469015j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.2406063+0.0678867j 0.2406063+0.0678867j]</span>
<span class="c1">#     [0.2406063+0.0678867j 0.2406063+0.0678867j]]]</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   [[[0.2406063+0.0678867j 0.2406063+0.0678867j]</span>
<span class="c1">#     [0.2406063+0.0678867j 0.2406063+0.0678867j]]</span>
<span class="c1">#</span>
<span class="c1">#    [[0.2969014-0.0837703j 0.2406063-0.0678867j]</span>
<span class="c1">#     [0.2406063-0.0678867j 0.2406063-0.0678867j]]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="id42">
<h2>测量接口<a class="headerlink" href="#id42" title="Link to this heading">¶</a></h2>
<section id="vqc-purity">
<h3>VQC_Purity<a class="headerlink" href="#vqc-purity" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_Purity">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_Purity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qubits_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_wires</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_Purity" title="Link to this definition">¶</a></dt>
<dd><p>从态矢中计算特定量子比特 <code class="docutils literal notranslate"><span class="pre">qubits_idx</span></code> 上的纯度。</p>
<div class="math notranslate nohighlight">
\[\gamma = \text{Tr}(\rho^2)\]</div>
<p>式中 <span class="math notranslate nohighlight">\(\rho\)</span> 为密度矩阵。标准化量子态的纯度满足 <span class="math notranslate nohighlight">\(\frac{1}{d} \leq \gamma \leq 1\)</span> ,
其中 <span class="math notranslate nohighlight">\(d\)</span> 是希尔伯特空间的维数。
纯态的纯度是1。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – 从pyqpanda get_qstate()获取的量子态</p></li>
<li><p><strong>qubits_idx</strong> – 要计算纯度的量子比特位索引</p></li>
<li><p><strong>num_wires</strong> – 量子比特数</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>对应比特位置上的纯度。</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>该函数结果一般为[b,len(qubits_idx)],其中b为 q_machine.reset_states(b)的批处理数量b。</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_Purity</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">cnot</span><span class="p">,</span> <span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">kfloat64</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.7</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">]],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">rx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">VQC_Purity</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">num_wires</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># [0.9356751 0.875957]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-varmeasure">
<h3>VQC_VarMeasure<a class="headerlink" href="#vqc-varmeasure" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_VarMeasure">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_VarMeasure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_VarMeasure" title="Link to this definition">¶</a></dt>
<dd><p>提供的可观察量 <code class="docutils literal notranslate"><span class="pre">obs</span></code> 的方差。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 从pyqpanda get_qstate()获取的量子态</p></li>
<li><p><strong>obs</strong> – 测量观测量,当前支持Hadamard,I,PauliX,PauliY,PauliZ 几种Observable.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>计算可观测量方差。</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>测量结果一般为[b,1],其中b为 q_machine.reset_states(b)的批处理数量b。</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_VarMeasure</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">cnot</span><span class="p">,</span> <span class="n">hadamard</span><span class="p">,</span> <span class="n">QMachine</span><span class="p">,</span><span class="n">PauliY</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">]],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">rx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">var_result</span> <span class="o">=</span> <span class="n">VQC_VarMeasure</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span> <span class="n">qm</span><span class="p">,</span> <span class="n">obs</span><span class="o">=</span><span class="n">PauliY</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">var_result</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">var_result</span><span class="p">)</span>

<span class="c1"># [[0.7701511]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-densitymatrixfromqstate">
<h3>VQC_DensityMatrixFromQstate<a class="headerlink" href="#vqc-densitymatrixfromqstate" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_DensityMatrixFromQstate">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_DensityMatrixFromQstate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_DensityMatrixFromQstate" title="Link to this definition">¶</a></dt>
<dd><p>计算量子态在一组特定量子比特上的密度矩阵。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – 一维列表状态向量。 这个列表的大小应该是 <code class="docutils literal notranslate"><span class="pre">(2**N,)</span></code> 对于量子比特个数 <code class="docutils literal notranslate"><span class="pre">N</span></code> ,qstate 应该从 000 -&gt;111 开始。</p></li>
<li><p><strong>indices</strong> – 所考虑子系统中的量子比特索引列表。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>大小为“(b, 2**len(indices), 2**len(indices))”的密度矩阵,其中b为 q_machine.reset_states(b)的批处理数量b。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_DensityMatrixFromQstate</span><span class="p">,</span><span class="n">rx</span><span class="p">,</span><span class="n">ry</span><span class="p">,</span><span class="n">cnot</span><span class="p">,</span><span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">kfloat64</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([[</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.4</span><span class="p">],[</span><span class="mf">1.7</span><span class="p">,</span><span class="mf">2.4</span><span class="p">]],</span><span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">rx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">VQC_DensityMatrixFromQstate</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># [[[0.8155131+0.j        0.1718155+0.j        0.       +0.0627175j</span>
<span class="c1">#   0.       +0.2976855j]</span>
<span class="c1">#  [0.1718155+0.j        0.0669081+0.j        0.       +0.0244234j</span>
<span class="c1">#   0.       +0.0627175j]</span>
<span class="c1">#  [0.       -0.0627175j 0.       -0.0244234j 0.0089152+0.j</span>
<span class="c1">#   0.0228937+0.j       ]</span>
<span class="c1">#  [0.       -0.2976855j 0.       -0.0627175j 0.0228937+0.j</span>
<span class="c1">#   0.1086637+0.j       ]]</span>
<span class="c1">#</span>
<span class="c1"># [[0.3362115+0.j        0.1471083+0.j        0.       +0.1674582j</span>
<span class="c1">#   0.       +0.3827205j]</span>
<span class="c1">#  [0.1471083+0.j        0.0993662+0.j        0.       +0.1131119j</span>
<span class="c1">#   0.       +0.1674582j]</span>
<span class="c1">#  [0.       -0.1674582j 0.       -0.1131119j 0.1287589+0.j</span>
<span class="c1">#   0.1906232+0.j       ]</span>
<span class="c1">#  [0.       -0.3827205j 0.       -0.1674582j 0.1906232+0.j</span>
<span class="c1">#   0.4356633+0.j       ]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="probability">
<h3>Probability<a class="headerlink" href="#probability" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.Probability">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">Probability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.Probability" title="Link to this definition">¶</a></dt>
<dd><p>一个计算量子线路在特定比特上概率测量的Module类。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wires</strong> – 测量比特的索引,列表、元组或者整数。</p></li>
<li><p><strong>name</strong> – 模块的名字,默认:””。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个概率测量的类。</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.Probability.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.Probability.forward" title="Link to this definition">¶</a></dt>
<dd><p>进行概率测量计算</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q_machine</strong> – 作用的量子态矢模拟器</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>概率测量结果</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>使用该类进行计算的概率测量结果一般为[b,len(wires)],其中b为 q_machine.reset_states(b)的批处理数量b。</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Probability</span><span class="p">,</span><span class="n">rx</span><span class="p">,</span><span class="n">ry</span><span class="p">,</span><span class="n">cnot</span><span class="p">,</span><span class="n">QMachine</span><span class="p">,</span><span class="n">rz</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">kfloat64</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([[</span><span class="mf">0.56</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],[</span><span class="mf">0.56</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]],</span><span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">rz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">rz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">rz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">Probability</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span><span class="n">ma</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">)</span>

<span class="c1"># [[1.0000002 0.       ]</span>
<span class="c1">#  [1.0000002 0.       ]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="measureall">
<h3>MeasureAll<a class="headerlink" href="#measureall" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.MeasureAll">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">MeasureAll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.MeasureAll" title="Link to this definition">¶</a></dt>
<dd><p>计算量子线路的测量结果,支持输入观测量 <code class="docutils literal notranslate"><span class="pre">obs</span></code> 为由观测量 <cite>observables</cite>、作用比特 <cite>wires</cite> 、系数 <cite>coefficient</cite> 键值对构成的字典,或者键值对字典列表。
例如:</p>
<p>{'wires': [0,  1], 'observables': ['x', 'i'],'coefficient':[0.23,-3.5]}</p>
<p>{'X0': 0.23}</p>
<p>[{'wires': [0, 2, 3],'observables': ['X', 'Y', 'Z'],'coefficient': [1, 0.5, 0.4]}, {'wires': [0, 1, 2],'observables': ['X', 'Y', 'Z'],'coefficient': [1, 0.5, 0.4]}]</p>
<p>[{'X1 Z2 I0':4,'Z1 Z0':3},{‘wires': [0,  1], 'observables': ['x', 'i'],'coefficient':[0.23,-3.5]}]</p>
<p>{'X1 Z2 I0':4,'Z1 Z0':3}</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> – 测量观测量,可以是单个观测量类包括,或者由观测量、作用比特、系数键值对构成的字典,或者键值对字典列表。</p></li>
<li><p><strong>name</strong> – 模块的名字,默认:””。</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.MeasureAll.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.MeasureAll.forward" title="Link to this definition">¶</a></dt>
<dd><p>进行测量操作</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q_machine</strong> – 作用的量子态矢模拟器</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>测量结果,QTensor。</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>如果 <code class="docutils literal notranslate"><span class="pre">obs</span></code> 是列表,使用该类进行计算的测量结果一般为[b,obs的列表长度],其中b为 q_machine.reset_states(b)的批处理数量b。
如果 <code class="docutils literal notranslate"><span class="pre">obs</span></code> 是字典,使用该类进行计算的测量结果一般为[b,1],其中b为 q_machine.reset_states(b)的批处理数量b。</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">MeasureAll</span><span class="p">,</span><span class="n">rx</span><span class="p">,</span><span class="n">ry</span><span class="p">,</span><span class="n">cnot</span><span class="p">,</span><span class="n">QMachine</span><span class="p">,</span><span class="n">rz</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">kfloat64</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([[</span><span class="mf">0.56</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],[</span><span class="mf">0.56</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]],</span><span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 4 qubits</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="c1"># batch size = 2</span>
<span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">rz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">rz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">rz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">]])</span>

<span class="c1"># list of 2 observables</span>
<span class="n">obs_list</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="s1">&#39;wires&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="s1">&#39;observables&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">],</span>
    <span class="s1">&#39;coefficient&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>
<span class="p">},</span> <span class="p">{</span>
    <span class="s1">&#39;wires&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="s1">&#39;observables&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">],</span>
    <span class="s1">&#39;coefficient&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>
<span class="p">}]</span>

<span class="n">ma</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span> <span class="o">=</span> <span class="n">obs_list</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">ma</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">)</span>

<span class="c1">#return QTensor of [batch_size,len(obs)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># [[0.4000001 0.3980018]</span>
<span class="c1">#  [0.4000001 0.3980018]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="samples">
<h3>Samples<a class="headerlink" href="#samples" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.Samples">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">Samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wires</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.Samples" title="Link to this definition">¶</a></dt>
<dd><p>获取特定线路 <code class="docutils literal notranslate"><span class="pre">wires</span></code> 上的带有 <code class="docutils literal notranslate"><span class="pre">shots</span></code> 的观测量 <code class="docutils literal notranslate"><span class="pre">obs</span></code> 结果。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wires</strong> – 样本量子比特索引。默认值:None,根据运行时使用模拟器的所有比特。</p></li>
<li><p><strong>obs</strong> – 该值只能设为None。</p></li>
<li><p><strong>shots</strong> – 样本重复次数,默认值:1。</p></li>
<li><p><strong>name</strong> – 此模块的名称,默认值:“”。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个测量方法类</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.Samples.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.Samples.forward" title="Link to this definition">¶</a></dt>
<dd><p>进行采样操作。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q_machine</strong> – 作用的量子态矢模拟器</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>测量结果,QTensor。</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>使用该类进行计算的测量结果一般为[b,shots,len(wires)],其中b为 q_machine.reset_states(b)的批处理数量b。</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Samples</span><span class="p">,</span><span class="n">rx</span><span class="p">,</span><span class="n">ry</span><span class="p">,</span><span class="n">cnot</span><span class="p">,</span><span class="n">QMachine</span><span class="p">,</span><span class="n">rz</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">kfloat64</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([[</span><span class="mf">0.56</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],[</span><span class="mf">0.56</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]],</span><span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">rz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">rx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">]])</span>


<span class="n">ma</span> <span class="o">=</span> <span class="n">Samples</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">shots</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ma</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">[[[0,0,0],</span>
<span class="sd">[0,1,0],</span>
<span class="sd">[0,0,0]],</span>

<span class="sd">[[0,1,0],</span>
<span class="sd">[0,0,0],</span>
<span class="sd">[0,1,0]]]</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="sparsehamiltonian">
<h3>SparseHamiltonian<a class="headerlink" href="#sparsehamiltonian" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.SparseHamiltonian">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">SparseHamiltonian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.SparseHamiltonian" title="Link to this definition">¶</a></dt>
<dd><p>计算观测量 <code class="docutils literal notranslate"><span class="pre">obs</span></code> 的稀疏哈密顿量,例如 {“observables”:H,”wires”:[0,2,3]}。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> – 稀疏观测量,使用 <cite>tensor.dense_to_csr()</cite> 函数获取稠密函数的稀疏格式。</p></li>
<li><p><strong>name</strong> – 模块的名字,默认:””。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个测量方法类</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.SparseHamiltonian.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.SparseHamiltonian.forward" title="Link to this definition">¶</a></dt>
<dd><p>进行稀疏哈密顿量测量。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q_machine</strong> – 作用的量子态矢模拟器</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>测量结果,QTensor。</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>使用该类进行计算的测量结果一般为[b,1],其中b为 q_machine.reset_states(b)的批处理数量b。</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet</span>
<span class="n">pyvqnet</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.nn</span><span class="w"> </span><span class="kn">import</span> <span class="n">Module</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span><span class="n">CRX</span><span class="p">,</span><span class="n">PauliX</span><span class="p">,</span><span class="n">paulix</span><span class="p">,</span><span class="n">crx</span><span class="p">,</span><span class="n">SparseHamiltonian</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">(</span>
<span class="p">[[</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
<span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
<span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
<span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
<span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
<span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
<span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
<span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
<span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
<span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
<span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
<span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
<span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
<span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
<span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
<span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,],</span>
<span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>
<span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span><span class="p">,]],</span><span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex64</span><span class="p">)</span>
<span class="n">cpu_csr</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">dense_to_csr</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">QModel</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span><span class="n">grad_mode</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_wires</span> <span class="o">=</span> <span class="n">num_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="n">num_wires</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">SparseHamiltonian</span><span class="p">(</span><span class="n">obs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;observables&quot;</span><span class="p">:</span><span class="n">cpu_csr</span><span class="p">,</span> <span class="s2">&quot;wires&quot;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">paulix</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">paulix</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">crx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span><span class="n">params</span><span class="o">=</span><span class="n">tensor</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">),</span><span class="mf">0.1</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex64</span><span class="p">))</span>
        <span class="n">crx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span><span class="n">params</span><span class="o">=</span><span class="n">tensor</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">),</span><span class="mf">0.2</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex64</span><span class="p">))</span>
        <span class="n">crx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span><span class="n">params</span><span class="o">=</span><span class="n">tensor</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">),</span><span class="mf">0.3</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex64</span><span class="p">))</span>
        <span class="n">crx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span><span class="n">params</span><span class="o">=</span><span class="n">tensor</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">),</span><span class="mf">0.3</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex64</span><span class="p">))</span>
        <span class="n">crx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span><span class="n">params</span><span class="o">=</span><span class="n">tensor</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">),</span><span class="mf">0.3</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex64</span><span class="p">))</span>

        <span class="n">rlt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rlt</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">QModel</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex64</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">tensor</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="c1">#[0.]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="hermitianexpval">
<h3>HermitianExpval<a class="headerlink" href="#hermitianexpval" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.HermitianExpval">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">HermitianExpval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.HermitianExpval" title="Link to this definition">¶</a></dt>
<dd><p>计算量子线路某个厄密特观测量 <code class="docutils literal notranslate"><span class="pre">obs</span></code> 的期望。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> – 厄密特观测量。</p></li>
<li><p><strong>name</strong> – 模块的名字,默认:””。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>期望结果,QTensor。</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.HermitianExpval.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.HermitianExpval.forward" title="Link to this definition">¶</a></dt>
<dd><p>进行厄密特量测量。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q_machine</strong> – 作用的量子态矢模拟器</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>测量结果,QTensor。</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>使用该类进行计算的测量结果一般为[b,1],其中b为 q_machine.reset_states(b)的批处理数量b。</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">qcircuit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">RX</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">CNOT</span><span class="p">,</span> <span class="n">PauliX</span><span class="p">,</span> <span class="n">qmatrix</span><span class="p">,</span> <span class="n">PauliZ</span><span class="p">,</span> <span class="n">VQC_RotCircuit</span><span class="p">,</span><span class="n">HermitianExpval</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span><span class="p">,</span> <span class="n">tensor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.nn</span><span class="w"> </span><span class="kn">import</span> <span class="n">Parameter</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">bsz</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="k">class</span><span class="w"> </span><span class="nc">QModel</span><span class="p">(</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rot_param</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rot_param</span><span class="o">.</span><span class="n">copy_value_from</span><span class="p">(</span><span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_wires</span> <span class="o">=</span> <span class="n">num_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rx_layer1</span> <span class="o">=</span> <span class="n">VQC_RotCircuit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ry_layer2</span> <span class="o">=</span> <span class="n">RY</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                            <span class="n">init_params</span><span class="o">=</span><span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlayer</span> <span class="o">=</span> <span class="n">PauliX</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnot</span> <span class="o">=</span> <span class="n">CNOT</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">HermitianExpval</span><span class="p">(</span><span class="n">obs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;wires&#39;</span><span class="p">:(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="s1">&#39;observables&#39;</span><span class="p">:</span><span class="n">tensor</span><span class="o">.</span><span class="n">to_tensor</span><span class="p">(</span><span class="n">H</span><span class="p">)})</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">qcircuit</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">qcircuit</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlayer</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rx_layer1</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rot_param</span><span class="p">,</span> <span class="n">wire</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ry_layer2</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="n">rlt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rlt</span>


<span class="n">input_x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bsz</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kfloat32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">bsz</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">input_x</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">qunatum_model</span> <span class="o">=</span> <span class="n">QModel</span><span class="p">(</span><span class="n">num_wires</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex64</span><span class="p">)</span>

<span class="n">batch_y</span> <span class="o">=</span> <span class="n">qunatum_model</span><span class="p">(</span><span class="n">input_x</span><span class="p">)</span>
<span class="n">batch_y</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">batch_y</span><span class="p">)</span>


<span class="c1"># [[5.3798223],</span>
<span class="c1">#  [7.1294155],</span>
<span class="c1">#  [0.7028297]]</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="id43">
<h2>常用量子变分线路模板<a class="headerlink" href="#id43" title="Link to this heading">¶</a></h2>
<section id="vqc-hardwareefficientansatz">
<h3>VQC_HardwareEfficientAnsatz<a class="headerlink" href="#vqc-hardwareefficientansatz" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_HardwareEfficientAnsatz">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_HardwareEfficientAnsatz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_qubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single_rot_gate_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entangle_gate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CNOT'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entangle_rules</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_HardwareEfficientAnsatz" title="Link to this definition">¶</a></dt>
<dd><p>一个含可训练参数的变分量子线路类,实现了论文介绍的Hardware Efficient Ansatz的实现: <a class="reference external" href="https://arxiv.org/pdf/1704.05018.pdf">Hardware-efficient Variational Quantum Eigensolver for Small Molecules</a> 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_qubits</strong> – 量子比特数。</p></li>
<li><p><strong>single_rot_gate_list</strong> – 单个量子比特旋转门列表由一个或多个作用于每个量子比特的旋转门构成。目前支持 Rx、Ry、Rz。</p></li>
<li><p><strong>entangle_gate</strong> – 非参数化纠缠门。支持 CNOT、CZ。默认值: CNOT。</p></li>
<li><p><strong>entangle_rules</strong> – 纠缠门在电路中的使用方式。”linear” 表示纠缠门将作用于每个相邻的量子比特。’all’ 表示纠缠门将作用于任意两个量子比特。默认值: “linear”。</p></li>
<li><p><strong>depth</strong> – 假设的深度, 默认值: 1。</p></li>
<li><p><strong>initial</strong> – 使用initial 初始化所有其中参数逻辑门的参数, 默认值: None, 此模块将随机初始化参数。</p></li>
<li><p><strong>dtype</strong> – 参数的数据类型,默认值: None,使用 float32。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 VQC_HardwareEfficientAnsatz 实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.nn</span><span class="w"> </span><span class="kn">import</span> <span class="n">Module</span><span class="p">,</span><span class="n">Linear</span><span class="p">,</span><span class="n">ModuleList</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc.qcircuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_HardwareEfficientAnsatz</span><span class="p">,</span><span class="n">RZZ</span><span class="p">,</span><span class="n">RZ</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Probability</span><span class="p">,</span><span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>

<span class="k">class</span><span class="w"> </span><span class="nc">QM</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linearx</span> <span class="o">=</span> <span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ansatz</span> <span class="o">=</span> <span class="n">VQC_HardwareEfficientAnsatz</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;rx&quot;</span><span class="p">,</span> <span class="s2">&quot;RY&quot;</span><span class="p">,</span> <span class="s2">&quot;rz&quot;</span><span class="p">],</span>
                                    <span class="n">entangle_gate</span><span class="o">=</span><span class="s2">&quot;cnot&quot;</span><span class="p">,</span>
                                    <span class="n">entangle_rules</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
                                    <span class="n">depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encode1</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encode2</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">Probability</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearx</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encode1</span><span class="p">(</span><span class="n">params</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span><span class="n">q_machine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encode2</span><span class="p">(</span><span class="n">params</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">q_machine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ansatz</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

<span class="n">bz</span> <span class="o">=</span><span class="mi">3</span>
<span class="n">inputx</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="n">bz</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">bz</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">inputx</span><span class="o">.</span><span class="n">requires_grad</span><span class="o">=</span> <span class="kc">True</span>
<span class="n">qlayer</span> <span class="o">=</span> <span class="n">QM</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">qlayer</span><span class="p">(</span><span class="n">inputx</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># [[0.3075959 0.2315064 0.2491432 0.2117545]</span>
<span class="c1">#  [0.3075958 0.2315062 0.2491433 0.2117546]</span>
<span class="c1">#  [0.3075958 0.2315062 0.2491432 0.2117545]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-basicentanglertemplate">
<h3>VQC_BasicEntanglerTemplate<a class="headerlink" href="#vqc-basicentanglertemplate" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_BasicEntanglerTemplate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_BasicEntanglerTemplate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_qubits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RX'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_BasicEntanglerTemplate" title="Link to this definition">¶</a></dt>
<dd><p>由每个量子位上的单参数单量子位旋转组成的层,后跟一个闭合链或环组合的多个CNOT 门构成的类。</p>
<p>CNOT 门环将每个量子位与其邻居连接起来,最后一个量子位被认为是第一个量子位的邻居。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_layer</strong> – 量子比特线路层数。</p></li>
<li><p><strong>num_qubits</strong> – 量子比特数,默认为1。</p></li>
<li><p><strong>rotation</strong> – 使用单参数单量子比特门,``RX`` 被用作默认值。</p></li>
<li><p><strong>initial</strong> – 使用initial 初始化所有其中参数逻辑门的参数, 默认值: None, 此模块将随机初始化参数。</p></li>
<li><p><strong>dtype</strong> – 参数的数据类型,默认值: None,使用 float32。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>返回一个含可训练参数的VQC_BasicEntanglerTemplate实例。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.nn</span><span class="w"> </span><span class="kn">import</span> <span class="n">Module</span><span class="p">,</span> <span class="n">Linear</span><span class="p">,</span> <span class="n">ModuleList</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc.qcircuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_BasicEntanglerTemplate</span><span class="p">,</span> <span class="n">RZZ</span><span class="p">,</span> <span class="n">RZ</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Probability</span><span class="p">,</span> <span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>


<span class="k">class</span><span class="w"> </span><span class="nc">QM</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ansatz</span> <span class="o">=</span> <span class="n">VQC_BasicEntanglerTemplate</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                            <span class="mi">4</span><span class="p">,</span>
                                            <span class="s2">&quot;rz&quot;</span><span class="p">,</span>
                                            <span class="n">initial</span><span class="o">=</span><span class="n">tensor</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">Probability</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ansatz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

<span class="n">bz</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">inputx</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">bz</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">bz</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">qlayer</span> <span class="o">=</span> <span class="n">QM</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">qlayer</span><span class="p">(</span><span class="n">inputx</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># [[1.0000002 0.        0.        0.       ]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-stronglyentanglingtemplate">
<h3>VQC_StronglyEntanglingTemplate<a class="headerlink" href="#vqc-stronglyentanglingtemplate" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_StronglyEntanglingTemplate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_StronglyEntanglingTemplate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_layers=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_qubits=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotation</span> <span class="pre">=</span> <span class="pre">&quot;RX&quot;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype:</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_StronglyEntanglingTemplate" title="Link to this definition">¶</a></dt>
<dd><p>由单个量子比特旋转和纠缠器组成的层,参考 <a class="reference external" href="https://arxiv.org/abs/1804.00633">circuit-centric classifier design</a> .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_layers</strong> – 重复层数,默认值: 1。</p></li>
<li><p><strong>num_qubits</strong> – 量子比特数,默认值: 1。</p></li>
<li><p><strong>rotation</strong> – 要使用的单参数单量子比特门,默认值: <cite>RX</cite></p></li>
<li><p><strong>initial</strong> – 使用initial 初始化所有其中参数逻辑门的参数,默认值: None,此模块将随机初始化参数。</p></li>
<li><p><strong>dtype</strong> – 参数的数据类型,默认值: None,使用 float32。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>VQC_BasicEntanglerTemplate 实例</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.nn</span><span class="w"> </span><span class="kn">import</span> <span class="n">Module</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc.qcircuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_StronglyEntanglingTemplate</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Probability</span><span class="p">,</span> <span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>


<span class="k">class</span><span class="w"> </span><span class="nc">QM</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ansatz</span> <span class="o">=</span> <span class="n">VQC_StronglyEntanglingTemplate</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                            <span class="mi">4</span><span class="p">,</span>
                                            <span class="kc">None</span><span class="p">,</span>
                                            <span class="n">initial</span><span class="o">=</span><span class="n">tensor</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">Probability</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ansatz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

<span class="n">bz</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">inputx</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">bz</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">bz</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">qlayer</span> <span class="o">=</span> <span class="n">QM</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">qlayer</span><span class="p">(</span><span class="n">inputx</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># [[0.3745951 0.154298  0.059156  0.4119509]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-quantumembedding">
<h3>VQC_QuantumEmbedding<a class="headerlink" href="#vqc-quantumembedding" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_QuantumEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_QuantumEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_repetitions_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_unitary_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_repetitions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_QuantumEmbedding" title="Link to this definition">¶</a></dt>
<dd><p>使用 RZ,RY,RZ 创建变分量子电路,将经典数据编码为量子态。
参考 <a class="reference external" href="https://arxiv.org/abs/2001.03622">Quantum embeddings for machine learning</a>。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_repetitions_input</strong> – 子模块中输入编码的重复次数。</p></li>
<li><p><strong>num_unitary_layers</strong> – 变分量子门的重复次数。</p></li>
<li><p><strong>num_repetitions</strong> – 子模块的重复次数。</p></li>
<li><p><strong>initial</strong> – 参数初始化值,默认为None</p></li>
<li><p><strong>dtype</strong> – 参数的类型,默认 None,使用float32.</p></li>
<li><p><strong>name</strong> – 类的名字</p></li>
</ul>
</dd>
<dt class="field-even">Paramdepth_input<span class="colon">:</span></dt>
<dd class="field-even"><p>输入维数。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.nn</span><span class="w"> </span><span class="kn">import</span> <span class="n">Module</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc.qcircuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_QuantumEmbedding</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span>  <span class="n">QMachine</span><span class="p">,</span><span class="n">MeasureAll</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet</span>
<span class="n">depth_input</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">num_repetitions</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">num_repetitions_input</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">num_unitary_layers</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">nq</span> <span class="o">=</span> <span class="n">depth_input</span> <span class="o">*</span> <span class="n">num_repetitions_input</span>
<span class="n">bz</span> <span class="o">=</span> <span class="mi">12</span>

<span class="k">class</span><span class="w"> </span><span class="nc">QM</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ansatz</span> <span class="o">=</span> <span class="n">VQC_QuantumEmbedding</span><span class="p">(</span><span class="n">num_repetitions_input</span><span class="p">,</span> <span class="n">depth_input</span><span class="p">,</span>
                                        <span class="n">num_unitary_layers</span><span class="p">,</span>
                                        <span class="n">num_repetitions</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="n">tensor</span><span class="o">.</span><span class="n">full</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span><span class="mf">12.0</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kfloat64</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;Z</span><span class="si">{</span><span class="n">nq</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="n">nq</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex128</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ansatz</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

<span class="n">inputx</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">bz</span> <span class="o">*</span> <span class="n">depth_input</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kfloat64</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">bz</span><span class="p">,</span> <span class="n">depth_input</span><span class="p">])</span>
<span class="n">qlayer</span> <span class="o">=</span> <span class="n">QM</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">qlayer</span><span class="p">(</span><span class="n">inputx</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># [[-0.2539548]</span>
<span class="c1">#  [-0.1604787]</span>
<span class="c1">#  [ 0.1492931]</span>
<span class="c1">#  [-0.1711956]</span>
<span class="c1">#  [-0.1577133]</span>
<span class="c1">#  [ 0.1396999]</span>
<span class="c1">#  [ 0.016864 ]</span>
<span class="c1">#  [-0.0893069]</span>
<span class="c1">#  [ 0.1897014]</span>
<span class="c1">#  [ 0.0941301]</span>
<span class="c1">#  [ 0.0550722]</span>
<span class="c1">#  [ 0.2408579]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="expressiveentanglingansatz">
<h3>ExpressiveEntanglingAnsatz<a class="headerlink" href="#expressiveentanglingansatz" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.ExpressiveEntanglingAnsatz">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">ExpressiveEntanglingAnsatz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_wires</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.ExpressiveEntanglingAnsatz" title="Link to this definition">¶</a></dt>
<dd><p>论文 <a class="reference external" href="https://arxiv.org/pdf/1905.10876.pdf">Expressibility and entangling capability of parameterized quantum circuits for hybrid quantum-classical algorithms</a> 中的 19 种不同的ansatz。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>type</strong> – 电路类型从 1 到 19,共19种线路。</p></li>
<li><p><strong>num_wires</strong> – 量子比特数。</p></li>
<li><p><strong>depth</strong> – 电路深度。</p></li>
<li><p><strong>dtype</strong> – 参数的数据类型, 默认值: None, 使用 float32。</p></li>
<li><p><strong>name</strong> – 名字,默认””.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 ExpressiveEntanglingAnsatz 实例</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w">  </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet</span>
<span class="n">pyvqnet</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.nn</span><span class="w"> </span><span class="kn">import</span> <span class="n">Module</span>
<span class="k">class</span><span class="w"> </span><span class="nc">QModel</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span><span class="n">grad_mode</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_wires</span> <span class="o">=</span> <span class="n">num_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span><span class="n">grad_mode</span><span class="o">=</span><span class="n">grad_mode</span><span class="p">,</span><span class="n">save_ir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c1</span> <span class="o">=</span> <span class="n">ExpressiveEntanglingAnsatz</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;wires&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s1">&#39;observables&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span>
            <span class="s1">&#39;coefficient&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">})</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="p">(</span><span class="n">q_machine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="n">rlt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rlt</span>


<span class="n">input_x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]])</span>

<span class="c1">#input_x = tensor.broadcast_to(input_x,[2,3])</span>

<span class="n">input_x</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">qunatum_model</span> <span class="o">=</span> <span class="n">QModel</span><span class="p">(</span><span class="n">num_wires</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex64</span><span class="p">)</span>

<span class="n">batch_y</span> <span class="o">=</span> <span class="n">qunatum_model</span><span class="p">(</span><span class="n">input_x</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">vqc_to_originir_list</span><span class="p">(</span><span class="n">qunatum_model</span><span class="p">)</span>
<span class="k">for</span> <span class="n">zi</span> <span class="ow">in</span> <span class="n">z</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">zi</span><span class="p">)</span>
<span class="n">batch_y</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">batch_y</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-basisembedding">
<h3>VQC_BasisEmbedding<a class="headerlink" href="#vqc-basisembedding" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_BasisEmbedding">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_BasisEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basis_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_BasisEmbedding" title="Link to this definition">¶</a></dt>
<dd><p>将二进制特征 <code class="docutils literal notranslate"><span class="pre">basis_state</span></code> 编码为 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code> 的基态。</p>
<p>例如, 对于 <code class="docutils literal notranslate"><span class="pre">basis_state=([0,</span> <span class="pre">1,</span> <span class="pre">1])</span></code>, 在量子系统下其基态为 <span class="math notranslate nohighlight">\(|011 \rangle\)</span>。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basis_state</strong> – <code class="docutils literal notranslate"><span class="pre">(n)</span></code> 大小的二进制输入。</p></li>
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_BasisEmbedding</span><span class="p">,</span><span class="n">QMachine</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">VQC_BasisEmbedding</span><span class="p">(</span><span class="n">basis_state</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[0.+0.j 0.+0.j]</span>
<span class="c1">#    [0.+0.j 0.+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#   [[0.+0.j 0.+0.j]</span>
<span class="c1">#    [1.+0.j 0.+0.j]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-angleembedding">
<h3>VQC_AngleEmbedding<a class="headerlink" href="#vqc-angleembedding" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_AngleEmbedding">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_AngleEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_machine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyvqnet.qnn.vqc.QMachine" title="pyvqnet.qnn.vqc.QMachine"><span class="pre">pyvqnet.qnn.vqc.QMachine</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'X'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_AngleEmbedding" title="Link to this definition">¶</a></dt>
<dd><p>将 <span class="math notranslate nohighlight">\(N\)</span> 特征编码到 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code> <span class="math notranslate nohighlight">\(n\)</span> 量子比特的旋转角度中, 其中 <span class="math notranslate nohighlight">\(N \leq n\)</span>。</p>
<p>旋转可以选择为 : ‘X’ , ‘Y’ , ‘Z’, 如 <code class="docutils literal notranslate"><span class="pre">rotation</span></code> 的参数定义为:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rotation='X'</span></code> 将特征用作RX旋转的角度。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rotation='Y'</span></code> 将特征用作RY旋转的角度。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rotation='Z'</span></code> 将特征用作RZ旋转的角度。</p></li>
</ul>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">wires</span></code> 代表旋转门在量子比特上的idx。</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_feat</strong> – 表示参数的数组。</p></li>
<li><p><strong>wires</strong> – 量子比特idx。</p></li>
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>rotation</strong> – 旋转门,默认为“X”。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_AngleEmbedding</span><span class="p">,</span> <span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">VQC_AngleEmbedding</span><span class="p">(</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">2.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
<span class="c1"># [[[ 0.398068 +0.j         0.       -0.2174655j]</span>
<span class="c1">#   [ 0.       -0.7821081j -0.4272676+0.j       ]]]</span>

<span class="n">VQC_AngleEmbedding</span><span class="p">(</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">2.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
<span class="c1"># [[[-0.0240995+0.6589843j  0.4207355+0.2476033j]</span>
<span class="c1">#   [ 0.4042482-0.2184162j  0.       -0.3401631j]]]</span>

<span class="n">VQC_AngleEmbedding</span><span class="p">(</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">2.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[0.659407 +0.0048471j 0.4870554-0.0332093j]</span>
<span class="c1">#   [0.4569675+0.047989j  0.340018 +0.0099326j]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-amplitudeembedding">
<h3>VQC_AmplitudeEmbedding<a class="headerlink" href="#vqc-amplitudeembedding" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_AmplitudeEmbeddingCircuit">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_AmplitudeEmbeddingCircuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_AmplitudeEmbeddingCircuit" title="Link to this definition">¶</a></dt>
<dd><p>将 <span class="math notranslate nohighlight">\(2^n\)</span> 特征编码为 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code>  <span class="math notranslate nohighlight">\(n\)</span> 量子比特的振幅向量。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_feature</strong> – 表示参数的numpy数组。</p></li>
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_AmplitudeEmbedding</span><span class="p">,</span> <span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">VQC_AmplitudeEmbedding</span><span class="p">(</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">3.2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[ 0.2473717+0.j -0.1546073+0.j]</span>
<span class="c1">#    [-0.1546073+0.j  0.0231911+0.j]]</span>
<span class="c1">#</span>
<span class="c1">#   [[ 0.9276441+0.j  0.0077304+0.j]</span>
<span class="c1">#    [ 0.1546073+0.j -0.0773037+0.j]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-iqpembedding">
<h3>VQC_IQPEmbedding<a class="headerlink" href="#vqc-iqpembedding" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_IQPEmbedding">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_IQPEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_machine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyvqnet.qnn.vqc.QMachine" title="pyvqnet.qnn.vqc.QMachine"><span class="pre">pyvqnet.qnn.vqc.QMachine</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_IQPEmbedding" title="Link to this definition">¶</a></dt>
<dd><p>使用IQP线路的对角门将 <span class="math notranslate nohighlight">\(n\)</span> 特征编码为 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code>  <span class="math notranslate nohighlight">\(n\)</span> 量子比特。</p>
<p>编码是由 <a class="reference external" href="https://arxiv.org/pdf/1804.11326.pdf">Havlicek et al. (2018)</a> 提出。</p>
<p>通过指定 <code class="docutils literal notranslate"><span class="pre">rep</span></code> ,可以重复基本IQP线路。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_feat</strong> – 表示参数的数组。</p></li>
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>rep</strong> – 重复量子线路块次数,默认次数为1。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_IQPEmbedding</span><span class="p">,</span> <span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">VQC_IQPEmbedding</span><span class="p">(</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">3.2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">]),</span> <span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[ 0.0309356-0.3521973j  0.3256442+0.1376801j]</span>
<span class="c1">#    [ 0.3256442+0.1376801j  0.2983474+0.1897071j]]</span>
<span class="c1">#</span>
<span class="c1">#   [[ 0.0309356+0.3521973j -0.3170519-0.1564546j]</span>
<span class="c1">#    [-0.3170519-0.1564546j -0.2310978-0.2675701j]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-rotcircuit">
<h3>VQC_RotCircuit<a class="headerlink" href="#vqc-rotcircuit" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_RotCircuit">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_RotCircuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wire</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_RotCircuit" title="Link to this definition">¶</a></dt>
<dd><p>在 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code> 的比特 <code class="docutils literal notranslate"><span class="pre">wire</span></code> 上使用 <code class="docutils literal notranslate"><span class="pre">params</span></code> 进行单量子比特旋转操作。</p>
<div class="math notranslate nohighlight">
\[\begin{split}R(\phi,\theta,\omega) = RZ(\omega)RY(\theta)RZ(\phi)= \begin{bmatrix}
e^{-i(\phi+\omega)/2}\cos(\theta/2) &amp; -e^{i(\phi-\omega)/2}\sin(\theta/2) \\
e^{-i(\phi-\omega)/2}\sin(\theta/2) &amp; e^{i(\phi+\omega)/2}\cos(\theta/2)
\end{bmatrix}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
<li><p><strong>wire</strong> – 量子比特索引。</p></li>
<li><p><strong>params</strong> – 表示参数  <span class="math notranslate nohighlight">\([\phi, \theta, \omega]\)</span>。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_RotCircuit</span><span class="p">,</span> <span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span>  <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">VQC_RotCircuit</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wire</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">2.1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[-0.3373617-0.6492732j  0.       +0.j       ]</span>
<span class="c1">#    [ 0.6807868-0.0340677j  0.       +0.j       ]]</span>
<span class="c1">#</span>
<span class="c1">#   [[ 0.       +0.j         0.       +0.j       ]</span>
<span class="c1">#    [ 0.       +0.j         0.       +0.j       ]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-crotcircuit">
<h3>VQC_CRotCircuit<a class="headerlink" href="#vqc-crotcircuit" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_CRotCircuit">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_CRotCircuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">para</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">control_qubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot_wire</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_CRotCircuit" title="Link to this definition">¶</a></dt>
<dd><p>在 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code> 的比特 <code class="docutils literal notranslate"><span class="pre">rot_wire</span></code> 以及受控比特 <code class="docutils literal notranslate"><span class="pre">control_qubits</span></code> 上使用 <code class="docutils literal notranslate"><span class="pre">params</span></code> 进行受控Rot操作符。</p>
<div class="math notranslate nohighlight">
\[\begin{split}CR(\phi, \theta, \omega) = \begin{bmatrix}
    1 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 1 &amp; 0 &amp; 0\\
    0 &amp; 0 &amp; e^{-i(\phi+\omega)/2}\cos(\theta/2) &amp; -e^{i(\phi-\omega)/2}\sin(\theta/2)\\
    0 &amp; 0 &amp; e^{-i(\phi-\omega)/2}\sin(\theta/2) &amp; e^{i(\phi+\omega)/2}\cos(\theta/2)
\end{bmatrix}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>para</strong> – 表示参数的数组。</p></li>
<li><p><strong>control_qubits</strong> – 控制量子比特索引。</p></li>
<li><p><strong>rot_wire</strong> – Rot量子比特索引。</p></li>
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc.qcircuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_CRotCircuit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">MeasureAll</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">])</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">VQC_CRotCircuit</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">qm</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Z0&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>

<span class="c1"># [[0.9999999]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-controlled-hadamard">
<h3>VQC_Controlled_Hadamard<a class="headerlink" href="#vqc-controlled-hadamard" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_Controlled_Hadamard">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_Controlled_Hadamard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_Controlled_Hadamard" title="Link to this definition">¶</a></dt>
<dd><p>在 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code> 的比特 <code class="docutils literal notranslate"><span class="pre">wire</span></code> 上使用受控Hadamard逻辑门</p>
<div class="math notranslate nohighlight">
\[\begin{split}CH = \begin{bmatrix}
    1 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 1 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; \frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{2}} \\
    0 &amp; 0 &amp; \frac{1}{\sqrt{2}} &amp; -\frac{1}{\sqrt{2}}
\end{bmatrix}.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wires</strong> – 量子比特索引列表, 第一位是控制比特, 列表长度为2。</p></li>
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc.qcircuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_Controlled_Hadamard</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">MeasureAll</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">])</span>

<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">VQC_Controlled_Hadamard</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">qm</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Z0&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>

<span class="c1"># [[1.]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-ccz">
<h3>VQC_CCZ<a class="headerlink" href="#vqc-ccz" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_CCZ">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_CCZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_CCZ" title="Link to this definition">¶</a></dt>
<dd><p>在 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code> 的比特 <code class="docutils literal notranslate"><span class="pre">wire</span></code> 上使用受控-受控-Z (controlled-controlled-Z) 逻辑门。</p>
<div class="math notranslate nohighlight">
\[\begin{split}CCZ =
\begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -1
\end{pmatrix}\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wires</strong> – 量子比特下标列表,第一位是控制比特。列表长度为3。</p></li>
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc.qcircuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_CCZ</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">MeasureAll</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">])</span>

<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">VQC_CCZ</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">qm</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Z0&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>

<span class="c1"># [[0.9999999]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-fermionicsingleexcitation">
<h3>VQC_FermionicSingleExcitation<a class="headerlink" href="#vqc-fermionicsingleexcitation" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_FermionicSingleExcitation">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_FermionicSingleExcitation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_FermionicSingleExcitation" title="Link to this definition">¶</a></dt>
<dd><p>在 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code> 的比特 <code class="docutils literal notranslate"><span class="pre">wire</span></code> 上使用由 <code class="docutils literal notranslate"><span class="pre">weight</span></code> 构成的泡利矩阵的张量积求幂的耦合簇单激励算子。矩阵形式下式给出:</p>
<div class="math notranslate nohighlight">
\[\hat{U}_{pr}(\theta) = \mathrm{exp} \{ \theta_{pr} (\hat{c}_p^\dagger \hat{c}_r
-\mathrm{H.c.}) \},\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weight</strong> – 量子比特p上的参数, 只有一个元素.</p></li>
<li><p><strong>wires</strong> – 表示区间[r, p]中的量子比特索引子集。最小长度必须为2。第一索引值被解释为r,最后一个索引值被解释为p。
中间的索引被CNOT门作用,以计算量子位集的奇偶校验。</p></li>
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc.qcircuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_FermionicSingleExcitation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">MeasureAll</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">p0</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">])</span>

<span class="n">VQC_FermionicSingleExcitation</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">qm</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Z0&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>

<span class="c1"># [[0.9999998]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-fermionicdoubleexcitation">
<h3>VQC_FermionicDoubleExcitation<a class="headerlink" href="#vqc-fermionicdoubleexcitation" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_FermionicDoubleExcitation">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_FermionicDoubleExcitation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_FermionicDoubleExcitation" title="Link to this definition">¶</a></dt>
<dd><p>在 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code> 的比特 <code class="docutils literal notranslate"><span class="pre">wire1</span></code> , <code class="docutils literal notranslate"><span class="pre">wire2</span></code> 上使用由 <code class="docutils literal notranslate"><span class="pre">weight</span></code> 对泡利矩阵的张量积求幂的耦合聚类双激励算子,矩阵形式由下式给出:</p>
<div class="math notranslate nohighlight">
\[\hat{U}_{pqrs}(\theta) = \mathrm{exp} \{ \theta (\hat{c}_p^\dagger \hat{c}_q^\dagger
\hat{c}_r \hat{c}_s - \mathrm{H.c.}) \},\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\hat{c}\)</span> 和 <span class="math notranslate nohighlight">\(\hat{c}^\dagger\)</span> 是费米子湮灭和
创建运算符和索引 <span class="math notranslate nohighlight">\(r, s\)</span> 和 <span class="math notranslate nohighlight">\(p, q\)</span> 在占用的和
分别为空分子轨道。 使用 <a class="reference external" href="https://arxiv.org/abs/1208.5986">Jordan-Wigner 变换</a> 上面定义的费米子算子可以写成
根据 Pauli 矩阵(有关更多详细信息,请参见
<a class="reference external" href="https://arxiv.org/abs/1805.04340">arXiv:1805.04340</a>)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\hat{U}_{pqrs}(\theta) = \mathrm{exp} \Big\{
\frac{i\theta}{8} \bigotimes_{b=s+1}^{r-1} \hat{Z}_b \bigotimes_{a=q+1}^{p-1}
\hat{Z}_a (\hat{X}_s \hat{X}_r \hat{Y}_q \hat{X}_p +
\hat{Y}_s \hat{X}_r \hat{Y}_q \hat{Y}_p +\\ \hat{X}_s \hat{Y}_r \hat{Y}_q \hat{Y}_p +
\hat{X}_s \hat{X}_r \hat{X}_q \hat{Y}_p - \mathrm{H.c.}  ) \Big\}\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weight</strong> – 可变参数</p></li>
<li><p><strong>wires1</strong> – 代表的量子比特的索引列表区间 [s, r] 中占据量子比特的子集。第一个索引被解释为 s,最后一索引被解释为 r。 CNOT 门对中间的索引进行操作,以计算一组量子位的奇偶性。</p></li>
<li><p><strong>wires2</strong> – 代表的量子比特的索引列表区间 [q, p] 中占据量子比特的子集。第一根索引被解释为 q,最后一索引被解释为 p。 CNOT 门对中间的索引进行操作,以计算一组量子位的奇偶性。</p></li>
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc.qcircuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_FermionicDoubleExcitation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">MeasureAll</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">p0</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">])</span>

<span class="n">VQC_FermionicDoubleExcitation</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">qm</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Z0&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>

<span class="c1"># [[0.9999998]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-uccsd">
<h3>VQC_UCCSD<a class="headerlink" href="#vqc-uccsd" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_UCCSD">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_UCCSD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_UCCSD" title="Link to this definition">¶</a></dt>
<dd><p>在 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code> 上实现酉耦合簇单激发和双激发拟设(UCCSD)。UCCSD 是 VQE 拟设,通常用于运行量子化学模拟。</p>
<p>在一阶 Trotter 近似内,UCCSD 酉函数由下式给出:</p>
<div class="math notranslate nohighlight">
\[\hat{U}(\vec{\theta}) =
\prod_{p &gt; r} \mathrm{exp} \Big\{\theta_{pr}
(\hat{c}_p^\dagger \hat{c}_r-\mathrm{H.c.}) \Big\}
\prod_{p &gt; q &gt; r &gt; s} \mathrm{exp} \Big\{\theta_{pqrs}
(\hat{c}_p^\dagger \hat{c}_q^\dagger \hat{c}_r \hat{c}_s-\mathrm{H.c.}) \Big\}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\hat{c}\)</span> 和 <span class="math notranslate nohighlight">\(\hat{c}^\dagger\)</span> 是费米子湮灭和
创建运算符和索引 <span class="math notranslate nohighlight">\(r, s\)</span> 和 <span class="math notranslate nohighlight">\(p, q\)</span> 在占用的和
分别为空分子轨道。(更多细节见
<a class="reference external" href="https://arxiv.org/abs/1805.04340">arXiv:1805.04340</a>):</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> – 包含参数的大小 <code class="docutils literal notranslate"><span class="pre">(len(s_wires)+</span> <span class="pre">len(d_wires))</span></code> 张量
<span class="math notranslate nohighlight">\(\theta_{pr}\)</span> 和 <span class="math notranslate nohighlight">\(\theta_{pqrs}\)</span> 输入 Z 旋转
<code class="docutils literal notranslate"><span class="pre">FermionicSingleExcitation</span></code> 和 <code class="docutils literal notranslate"><span class="pre">FermionicDoubleExcitation</span></code> 。</p></li>
<li><p><strong>wires</strong> – 模板作用的量子比特索引</p></li>
<li><p><strong>s_wires</strong> – 包含量子比特索引的列表序列 <code class="docutils literal notranslate"><span class="pre">[r,...,p]</span></code>
由单一激发产生
<span class="math notranslate nohighlight">\(\vert r, p \rangle = \hat{c}_p^\dagger \hat{c}_r \vert \mathrm{HF} \rangle\)</span>,
其中 <span class="math notranslate nohighlight">\(\vert \mathrm{HF} \rangle\)</span> 表示 Hartee-Fock 参考态。</p></li>
<li><p><strong>d_wires</strong> – 列表序列,每个列表包含两个列表
指定索引 <code class="docutils literal notranslate"><span class="pre">[s,</span> <span class="pre">...,r]</span></code> 和 <code class="docutils literal notranslate"><span class="pre">[q,...,</span> <span class="pre">p]</span></code>
定义双激励 <span class="math notranslate nohighlight">\(\vert s, r, q, p \rangle = \hat{c}_p^\dagger \hat{c}_q^\dagger \hat{c}_r\hat{c}_s \vert \mathrm{HF} \rangle\)</span> 。</p></li>
<li><p><strong>init_state</strong> – 长度 <code class="docutils literal notranslate"><span class="pre">len(wires)</span></code> occupation-number vector 表示
高频状态。 <code class="docutils literal notranslate"><span class="pre">init_state</span></code> 在量子比特初始化状态。</p></li>
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_UCCSD</span><span class="p">,</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">MeasureAll</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">p0</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">s_wires</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="n">d_wires</span> <span class="o">=</span> <span class="p">[[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]]</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="n">VQC_UCCSD</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">s_wires</span><span class="p">,</span> <span class="n">d_wires</span><span class="p">,</span> <span class="n">QTensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">qm</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Z1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>

<span class="c1"># [[0.963802]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-zfeaturemap">
<h3>VQC_ZFeatureMap<a class="headerlink" href="#vqc-zfeaturemap" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_ZFeatureMap">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_ZFeatureMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_machine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyvqnet.qnn.vqc.QMachine" title="pyvqnet.qnn.vqc.QMachine"><span class="pre">pyvqnet.qnn.vqc.QMachine</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_map_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_ZFeatureMap" title="Link to this definition">¶</a></dt>
<dd><p>在 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code> 上运行一阶泡利 Z 演化电路。</p>
<p>对于 3 个量子位和 2 次重复,电路表示为:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>┌───┐┌──────────────┐┌───┐┌──────────────┐
┤ H ├┤ U1(2.0*x[0]) ├┤ H ├┤ U1(2.0*x[0]) ├
├───┤├──────────────┤├───┤├──────────────┤
┤ H ├┤ U1(2.0*x[1]) ├┤ H ├┤ U1(2.0*x[1]) ├
├───┤├──────────────┤├───┤├──────────────┤
┤ H ├┤ U1(2.0*x[2]) ├┤ H ├┤ U1(2.0*x[2]) ├
└───┘└──────────────┘└───┘└──────────────┘
</pre></div>
</div>
<p>泡利弦固定为 <code class="docutils literal notranslate"><span class="pre">Z</span></code>。 因此,一阶展开将是一个没有纠缠门的电路。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_feat</strong> – 表示输入参数的数组。</p></li>
<li><p><strong>q_machine</strong> – 量子虚拟机。</p></li>
<li><p><strong>data_map_func</strong> – 参数映射矩阵, 为可调用函数, 设计方式为: <code class="docutils literal notranslate"><span class="pre">data_map_func</span> <span class="pre">=</span> <span class="pre">lambda</span> <span class="pre">x:</span> <span class="pre">x</span></code>。</p></li>
<li><p><strong>rep</strong> – 模块重复次数。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_ZFeatureMap</span><span class="p">,</span> <span class="n">QMachine</span><span class="p">,</span><span class="n">hadamard</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">hadamard</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">VQC_ZFeatureMap</span><span class="p">(</span><span class="n">input_feat</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">]]),</span><span class="n">q_machine</span> <span class="o">=</span> <span class="n">qm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[0.3535534+0.j        0.2918002+0.1996312j]</span>
<span class="c1">#    [0.3256442+0.1376801j 0.1910257+0.2975049j]]</span>
<span class="c1">#</span>
<span class="c1">#   [[0.3465058+0.0702402j 0.246323 +0.2536236j]</span>
<span class="c1">#    [0.2918002+0.1996312j 0.1281128+0.3295255j]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-zzfeaturemap">
<h3>VQC_ZZFeatureMap<a class="headerlink" href="#vqc-zzfeaturemap" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_ZZFeatureMap">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_ZZFeatureMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_machine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyvqnet.qnn.vqc.QMachine" title="pyvqnet.qnn.vqc.QMachine"><span class="pre">pyvqnet.qnn.vqc.QMachine</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_map_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entanglement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'full'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_ZZFeatureMap" title="Link to this definition">¶</a></dt>
<dd><p>在 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code> 上运行二阶 Pauli-Z 演化电路。</p>
<p>对于 3 个量子位、1 个重复和线性纠缠,电路表示为:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>┌───┐┌─────────────────┐
┤ H ├┤ U1(2.0*φ(x[0])) ├──■────────────────────────────■────────────────────────────────────
├───┤├─────────────────┤┌─┴─┐┌──────────────────────┐┌─┴─┐
┤ H ├┤ U1(2.0*φ(x[1])) ├┤ X ├┤ U1(2.0*φ(x[0],x[1])) ├┤ X ├──■────────────────────────────■──
├───┤├─────────────────┤└───┘└──────────────────────┘└───┘┌─┴─┐┌──────────────────────┐┌─┴─┐
┤ H ├┤ U1(2.0*φ(x[2])) ├──────────────────────────────────┤ X ├┤ U1(2.0*φ(x[1],x[2])) ├┤ X ├
└───┘└─────────────────┘                                  └───┘└──────────────────────┘└───┘
</pre></div>
</div>
<p>其中 <code class="docutils literal notranslate"><span class="pre">φ</span></code> 是经典的非线性函数,如果输入两个值则 <code class="docutils literal notranslate"><span class="pre">φ(x,y)</span> <span class="pre">=</span> <span class="pre">(pi</span> <span class="pre">-</span> <span class="pre">x)(pi</span> <span class="pre">-</span> <span class="pre">y)</span></code>, 输入一个则为 <code class="docutils literal notranslate"><span class="pre">φ(x)</span> <span class="pre">=</span> <span class="pre">x</span></code>, 用 <code class="docutils literal notranslate"><span class="pre">data_map_func</span></code> 表示如下:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">data_map_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">coeff</span> <span class="o">=</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">ft</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">y</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">coeff</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_feat</strong> – 表示输入参数的数组。</p></li>
<li><p><strong>q_machine</strong> – 量子虚拟机。</p></li>
<li><p><strong>data_map_func</strong> – 参数映射矩阵, 为可调用函数。</p></li>
<li><p><strong>entanglement</strong> – 指定的纠缠结构。</p></li>
<li><p><strong>rep</strong> – 模块重复次数。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_ZZFeatureMap</span><span class="p">,</span> <span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">VQC_ZZFeatureMap</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">input_feat</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">]]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[-0.4234843-0.0480578j -0.144067 +0.1220178j]</span>
<span class="c1">#    [-0.0800646+0.0484439j -0.5512857-0.2947832j]]</span>
<span class="c1">#</span>
<span class="c1">#   [[ 0.0084012-0.0050071j -0.2593993-0.2717131j]</span>
<span class="c1">#    [-0.1961917-0.3470543j  0.2786197+0.0732045j]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-allsinglesdoubles">
<h3>VQC_AllSinglesDoubles<a class="headerlink" href="#vqc-allsinglesdoubles" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_AllSinglesDoubles">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_AllSinglesDoubles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_machine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyvqnet.qnn.vqc.QMachine" title="pyvqnet.qnn.vqc.QMachine"><span class="pre">pyvqnet.qnn.vqc.QMachine</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">hf_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">singles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doubles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_AllSinglesDoubles" title="Link to this definition">¶</a></dt>
<dd><p>在这种情况下,我们有四个单激发和双激发来保留 Hartree-Fock 态的总自旋投影。</p>
<p>由此产生的酉矩阵保留了粒子数量,并在初始 Hartree-Fock 状态和编码多激发配置的其他状态的叠加中准备了n量子位系统。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> – 大小为 <code class="docutils literal notranslate"><span class="pre">(len(singles)</span> <span class="pre">+</span> <span class="pre">len(doubles),)</span></code> 的QTensor,包含按顺序进入 vqc.qCircuit.single_excitation 和 vqc.qCircuit.double_excitation 操作的角度</p></li>
<li><p><strong>q_machine</strong> – 量子虚拟机。</p></li>
<li><p><strong>hf_state</strong> – 代表 Hartree-Fock 状态的长度 <code class="docutils literal notranslate"><span class="pre">len(wires)</span></code> 占用数向量, <code class="docutils literal notranslate"><span class="pre">hf_state</span></code> 用于初始化线路。</p></li>
<li><p><strong>wires</strong> – 作用的量子位。</p></li>
<li><p><strong>singles</strong> – 具有single_exitation操作所作用的两个量子位索引的列表序列。</p></li>
<li><p><strong>doubles</strong> – 具有double_exitation操作所作用的两个量子位索引的列表序列。</p></li>
</ul>
</dd>
</dl>
<p>例如,两个电子和六个量子位情况下的量子电路如下图所示:</p>
</dd></dl>

<a class="reference internal image-reference" href="../_images/all_singles_doubles.png"><img alt="../_images/all_singles_doubles.png" class="align-center" src="../_images/all_singles_doubles.png" style="width: 600px;" />
</a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<blockquote>
<div><p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_AllSinglesDoubles</span><span class="p">,</span> <span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="n">qubits</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="n">qubits</span><span class="p">)</span>

<span class="n">VQC_AllSinglesDoubles</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">]),</span>
                      <span class="n">hf_state</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">singles</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]],</span> <span class="n">doubles</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]],</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [ 0.        +0.j  0.        +0.j  0.        +0.j -0.23728043+0.j</span>
<span class="c1">#   0.        +0.j  0.        +0.j -0.27552837+0.j  0.        +0.j</span>
<span class="c1">#   0.        +0.j -0.12207296+0.j  0.        +0.j  0.        +0.j</span>
<span class="c1">#   0.9235152 +0.j  0.        +0.j  0.        +0.j  0.        +0.j]</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="vqc-basisrotation">
<h3>VQC_BasisRotation<a class="headerlink" href="#vqc-basisrotation" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_BasisRotation">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_BasisRotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyvqnet.qnn.vqc.QMachine" title="pyvqnet.qnn.vqc.QMachine"><span class="pre">pyvqnet.qnn.vqc.QMachine</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unitary_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="QTensor.html#pyvqnet.tensor.tensor.QTensor" title="pyvqnet.tensor.tensor.QTensor"><span class="pre">QTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_BasisRotation" title="Link to this definition">¶</a></dt>
<dd><p>在 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code> 上实现一个电路,执行精确的单体基础旋转。</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">VQC_BasisRotation</span></code> 执行以下由 <a class="reference external" href="https://arxiv.org/abs/1711.04789">arXiv:1711.04789</a>中给出的单粒子费米子确定的酉变换 <span class="math notranslate nohighlight">\(U(u)\)</span></p>
<div class="math notranslate nohighlight">
\[U(u) = \exp{\left( \sum_{pq} \left[\log u \right]_{pq} (a_p^\dagger a_q - a_q^\dagger a_p) \right)}.\]</div>
<p><span class="math notranslate nohighlight">\(U(u)\)</span> 通过使用论文 <a class="reference external" href="https://opg.optica.org/optica/fulltext.cfm?uri=optica-3-12-1460&amp;id=355743">Optica, 3, 1460 (2016)</a>中给出的方案。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 量子虚拟机。</p></li>
<li><p><strong>wires</strong> – 作用的量子位。</p></li>
<li><p><strong>unitary_matrix</strong> – 指定基础变换的矩阵。</p></li>
<li><p><strong>check</strong> – 检测 <cite>unitary_matrix</cite> 是否为酉矩阵。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_BasisRotation</span><span class="p">,</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">hadamard</span><span class="p">,</span> <span class="n">isingzz</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.73678</span><span class="o">+</span><span class="mf">0.27511</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5095</span> <span class="o">+</span><span class="mf">0.10704</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.06847</span><span class="o">+</span><span class="mf">0.32515</span><span class="n">j</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.73678</span><span class="o">+</span><span class="mf">0.27511</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5095</span> <span class="o">+</span><span class="mf">0.10704</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.06847</span><span class="o">+</span><span class="mf">0.32515</span><span class="n">j</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mf">0.21271</span><span class="o">+</span><span class="mf">0.34938</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.38853</span><span class="o">+</span><span class="mf">0.36497</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.61467</span><span class="o">-</span><span class="mf">0.41317</span><span class="n">j</span><span class="p">]])</span>

<span class="n">eigen_vals</span><span class="p">,</span> <span class="n">eigen_vecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">umat</span> <span class="o">=</span> <span class="n">eigen_vecs</span><span class="o">.</span><span class="n">T</span>
<span class="n">wires</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">umat</span><span class="p">))</span>

<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">umat</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">umat</span><span class="p">)):</span>
    <span class="n">hadamard</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
<span class="n">isingzz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.55</span><span class="p">]),</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">VQC_BasisRotation</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">wires</span><span class="p">,</span><span class="n">unitary_matrix</span><span class="o">=</span><span class="n">QTensor</span><span class="p">(</span><span class="n">umat</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">qm</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">qm</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1"># [[[[ 0.3402686-0.0960063j  0.4140436-0.3069579j]</span>
<span class="c1">#    [ 0.1206574+0.1982292j  0.5662895-0.0949503j]]</span>
<span class="c1">#</span>
<span class="c1">#   [[-0.1715559-0.1614315j  0.1624039-0.0598041j]</span>
<span class="c1">#    [ 0.0608986-0.1078906j -0.305845 +0.1773662j]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-quantumpoolingcircuit">
<h3>VQC_QuantumPoolingCircuit<a class="headerlink" href="#vqc-quantumpoolingcircuit" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_QuantumPoolingCircuit">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_QuantumPoolingCircuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ignored_wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sinks_wires</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_QuantumPoolingCircuit" title="Link to this definition">¶</a></dt>
<dd><p>在 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code> 上对数据进行降采样的量子电路。为了减少电路中的量子位数量,首先在系统中创建成对的量子位。在最初配对所有量子位之后,将广义2量子位酉元应用于每一对量子位上。并在应用这两个量子位酉元之后,在神经网络的其余部分忽略每对量子位中的一个量子位。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sources_wires</strong> – 将被忽略的源量子位索引。</p></li>
<li><p><strong>sinks_wires</strong> – 将保留的目标量子位索引。</p></li>
<li><p><strong>params</strong> – 输入参数,形状应该为[ len(ignored_wires) + len(sinks_wires) // 2 * 3]。</p></li>
<li><p><strong>q_machine</strong> – 量子虚拟机设备。</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_QuantumPoolingCircuit</span><span class="p">,</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">MeasureAll</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">full</span><span class="p">([</span><span class="mi">6</span><span class="p">],</span> <span class="mf">0.35</span><span class="p">)</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">VQC_QuantumPoolingCircuit</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">,</span>
                        <span class="n">ignored_wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                        <span class="n">sinks_wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                        <span class="n">params</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Z1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-qft-add-to-register">
<h3>vqc_qft_add_to_register<a class="headerlink" href="#vqc-qft-add-to-register" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.vqc_qft_add_to_register">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">vqc_qft_add_to_register</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.vqc_qft_add_to_register" title="Link to this definition">¶</a></dt>
<dd><p>在 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code> 进行如下操作:将无符号整数 <cite>m</cite> 编码到量子比特中,然后将 <cite>k</cite> 加到此量子比特上。</p>
<div class="math notranslate nohighlight">
\[\text{Sum(k)}\vert m \rangle = \vert m + k \rangle.\]</div>
<p>实现此幺正运算的过程如下:
(1). 通过 将 QFT 应用于 <span class="math notranslate nohighlight">\(\vert m \rangle\)</span> 状态,将状态从计算基础转换为傅里叶基础。
(2). 使用 <span class="math notranslate nohighlight">\(R_Z\)</span> 门将 <span class="math notranslate nohighlight">\(j\)</span> 个量子比特旋转角度 <span class="math notranslate nohighlight">\(\frac{2k\pi}{2^{j}}\)</span>,从而得到新相 <span class="math notranslate nohighlight">\(\frac{2(m + k)\pi}{2^{j}}\)</span>。
(3). 应用 QFT 逆返回计算基础并得到 <span class="math notranslate nohighlight">\(m+k\)</span>。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 用于模拟的量子机。</p></li>
<li><p><strong>m</strong> – 嵌入寄存器的经典整数。</p></li>
<li><p><strong>k</strong> – 添加到寄存器的经典整数。</p></li>
</ul>
</dd>
<dt class="field-even">Retrun<span class="colon">:</span></dt>
<dd class="field-even"><p>返回目标和的二进制表示。</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>请注意 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code> 使用的比特数量需要足够使用X基态编码结果和的二进制值。</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span><span class="n">Samples</span><span class="p">,</span> <span class="n">vqc_qft_add_to_register</span>
<span class="n">dev</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">vqc_qft_add_to_register</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">Samples</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ma</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">dev</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="c1">#[[1,0,1,0]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-qft-add-two-register">
<h3>vqc_qft_add_two_register<a class="headerlink" href="#vqc-qft-add-two-register" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="vqc_qft_add_two_register">
<span class="sig-name descname"><span class="pre">vqc_qft_add_two_register</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires_solution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vqc_qft_add_two_register" title="Link to this definition">¶</a></dt>
<dd><p>在 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code> 进行如下操作: 将两个量子比特wires_m, wires_k中编码的无符号整数m, k进行加法,结果存在wires_solution比特上。</p>
<div class="math notranslate nohighlight">
\[\text{Sum}_2\vert m \rangle \vert k \rangle \vert 0 \rangle = \vert m \rangle \vert k \rangle \vert m+k \rangle\]</div>
<p>在这种情况下,我们可以将第三个寄存器(最初位于 <span class="math notranslate nohighlight">\(0\)</span>)理解为一个计数器,它将计算出 <span class="math notranslate nohighlight">\(m\)</span> 和 <span class="math notranslate nohighlight">\(k\)</span> 加起来的单位数。二进制分解将使这变得简单。如果我们有 <span class="math notranslate nohighlight">\(\vert m \rangle = \vert \overline{q_0q_1q_2} \rangle\)</span>,则如果 <span class="math notranslate nohighlight">\(q_2 = 1\)</span>,则我们必须将 <span class="math notranslate nohighlight">\(1\)</span> 添加到计数器,否则不添加任何内容。一般来说,如果 <span class="math notranslate nohighlight">\(i\)</span>-th 量子位处于 <span class="math notranslate nohighlight">\(\vert 1 \rangle\)</span> 状态,则我们应该添加 <span class="math notranslate nohighlight">\(2^{n-i-1}\)</span> 个单位,否则添加 0。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 用于模拟的量子机。</p></li>
<li><p><strong>m</strong> – 嵌入寄存器中的经典整数作为 lhs。</p></li>
<li><p><strong>k</strong> – 嵌入到寄存器中的经典整数作为 rhs。</p></li>
<li><p><strong>wires_m</strong> – 要编码 m 的量子比特的索引。</p></li>
<li><p><strong>wires_k</strong> – 要编码 k 的量子比特的索引。</p></li>
<li><p><strong>wires_solution</strong> – 要编码解决方案的量子比特的索引。</p></li>
</ul>
</dd>
<dt class="field-even">Retrun<span class="colon">:</span></dt>
<dd class="field-even"><p>返回目标和的二进制表示。</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">wires_m</span></code> 使用的比特数量需要足够使用X基态编码 <cite>m</cite> 的二进制值。
<code class="docutils literal notranslate"><span class="pre">wires_k</span></code> 使用的比特数量需要足够使用X基态编码 <cite>k</cite> 的二进制值。
<code class="docutils literal notranslate"><span class="pre">wires_solution</span></code> 使用的比特数量需要足够使用X基态编码结果的二进制值。</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span><span class="n">Samples</span><span class="p">,</span> <span class="n">vqc_qft_add_two_register</span>
<span class="n">wires_m</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>           <span class="c1"># qubits needed to encode m</span>
<span class="n">wires_k</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>           <span class="c1"># qubits needed to encode k</span>
<span class="n">wires_solution</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>  <span class="c1"># qubits needed to encode the solution</span>

<span class="n">wires_m</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>             <span class="c1"># qubits needed to encode m</span>
<span class="n">wires_k</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>             <span class="c1"># qubits needed to encode k</span>
<span class="n">wires_solution</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>   <span class="c1"># qubits needed to encode the solution</span>
<span class="n">dev</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wires_m</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">wires_k</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">wires_solution</span><span class="p">))</span>

<span class="n">vqc_qft_add_two_register</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">wires_m</span><span class="p">,</span> <span class="n">wires_k</span><span class="p">,</span> <span class="n">wires_solution</span><span class="p">)</span>

<span class="n">ma</span> <span class="o">=</span> <span class="n">Samples</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="n">wires_solution</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ma</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">dev</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-qft-mul">
<h3>vqc_qft_mul<a class="headerlink" href="#vqc-qft-mul" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="vqc_qft_mul">
<span class="sig-name descname"><span class="pre">vqc_qft_mul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires_solution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vqc_qft_mul" title="Link to this definition">¶</a></dt>
<dd><p>在 <code class="docutils literal notranslate"><span class="pre">q_machine</span></code> 进行如下操作: 将两个量子比特wires_m, wires_k中编码的数值m, k, 进行乘法,结果存在wires_solution比特上。</p>
<div class="math notranslate nohighlight">
\[\text{Mul}\vert m \rangle \vert k \rangle \vert 0 \rangle = \vert m \rangle \vert k \rangle \vert m\cdot k \rangle\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_machine</strong> – 用于模拟的量子机。</p></li>
<li><p><strong>m</strong> – 嵌入寄存器中的经典整数,作为左侧。</p></li>
<li><p><strong>k</strong> – 嵌入寄存器中的经典整数,作为右侧。</p></li>
<li><p><strong>wires_m</strong> – 要编码 m 的量子比特索引。</p></li>
<li><p><strong>wires_k</strong> – 要编码 k 的量子比特索引。</p></li>
<li><p><strong>wires_solution</strong> – 要编码解决方案的量子比特索引。</p></li>
</ul>
</dd>
<dt class="field-even">Retrun<span class="colon">:</span></dt>
<dd class="field-even"><p>返回目标乘积的二进制表示。</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">wires_m</span></code> 使用的比特数量需要足够使用X基态编码 <cite>m</cite> 的二进制值。
<code class="docutils literal notranslate"><span class="pre">wires_k</span></code> 使用的比特数量需要足够使用X基态编码 <cite>k</cite> 的二进制值。
<code class="docutils literal notranslate"><span class="pre">wires_solution</span></code> 使用的比特数量需要足够使用X基态编码结果的二进制值。</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span><span class="n">Samples</span><span class="p">,</span> <span class="n">vqc_qft_mul</span>
<span class="n">wires_m</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>           <span class="c1"># qubits needed to encode m</span>
<span class="n">wires_k</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>           <span class="c1"># qubits needed to encode k</span>
<span class="n">wires_solution</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>  <span class="c1"># qubits needed to encode the solution</span>

<span class="n">dev</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wires_m</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">wires_k</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">wires_solution</span><span class="p">))</span>

<span class="n">vqc_qft_mul</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">wires_m</span><span class="p">,</span> <span class="n">wires_k</span><span class="p">,</span> <span class="n">wires_solution</span><span class="p">)</span>


<span class="n">ma</span> <span class="o">=</span> <span class="n">Samples</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="n">wires_solution</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ma</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="n">dev</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="c1">#[[1,0,1,0,1]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-fable">
<h3>VQC_FABLE<a class="headerlink" href="#vqc-fable" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_FABLE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_FABLE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wires</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_FABLE" title="Link to this definition">¶</a></dt>
<dd><p>使用快速近似块编码方法构建基于 VQC 的 QCircuit。对于特定结构的矩阵 [<a class="reference external" href="https://arxiv.org/abs/2205.00081">arXiv:2205.00081</a>], FABLE 方法可以简化块编码电路而不降低准确性。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>wires</strong> – 运算符作用的 qlist 索引。</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>返回一个基于VQC的FABLE类实例。</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_FABLE</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.dtype</span><span class="w"> </span><span class="kn">import</span> <span class="n">float_dtype_to_complex_dtype</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span> <span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span> <span class="p">]])</span> <span class="p">)</span>
<span class="n">qf</span> <span class="o">=</span> <span class="n">VQC_FABLE</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">float_dtype_to_complex_dtype</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>
<span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">z1</span> <span class="o">=</span> <span class="n">qf</span><span class="p">(</span><span class="n">qm</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="mf">0.001</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">[[[[0.05     +0.j,0.15     +0.j],</span>
<span class="sd">[0.05     +0.j,0.15     +0.j]],</span>

<span class="sd">[[0.4974937+0.j,0.4769696+0.j],</span>
<span class="sd">[0.4974937+0.j,0.4769696+0.j]]]]</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-lcu">
<h3>VQC_LCU<a class="headerlink" href="#vqc-lcu" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_LCU">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_LCU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wires</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_LCU" title="Link to this definition">¶</a></dt>
<dd><p>使用线性组合单元 (LCU) 构建基于 VQC 的 QCircuit,`通过量子比特化进行哈密顿模拟 &lt;<a class="reference external" href="https://arxiv.org/abs/1610.06546">https://arxiv.org/abs/1610.06546</a>&gt;`_。
输入 dtype 可以是 kfloat32、kfloat64、kcomplex64、kcomplex128
输入应为 Hermitian。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wires</strong> – 运算符作用的 qlist 索引,可能需要辅助量子位。</p></li>
<li><p><strong>check_hermitian</strong> – 检查输入是否为 Hermitian,默认值:True。</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">VQC_LCU</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.dtype</span><span class="w"> </span><span class="kn">import</span> <span class="n">float_dtype_to_complex_dtype</span><span class="p">,</span><span class="n">kfloat64</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([[</span><span class="mf">0.25</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.75</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mf">0.75</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.25</span><span class="p">]],</span><span class="n">device</span><span class="o">=</span><span class="mi">1001</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">kfloat64</span><span class="p">)</span>
<span class="n">qf</span> <span class="o">=</span> <span class="n">VQC_LCU</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">float_dtype_to_complex_dtype</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>
<span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">z1</span> <span class="o">=</span> <span class="n">qf</span><span class="p">(</span><span class="n">qm</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z1</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">[[[[ 0.25     +0.j, 0.       +0.j],</span>
<span class="sd">[ 0.       +0.j, 0.75     +0.j]],</span>

<span class="sd">[[-0.4330127+0.j, 0.       +0.j],</span>
<span class="sd">[ 0.       +0.j, 0.4330127+0.j]]],</span>


<span class="sd">[[[ 0.25     +0.j, 0.       +0.j],</span>
<span class="sd">[ 0.       +0.j, 0.75     +0.j]],</span>

<span class="sd">[[-0.4330127+0.j, 0.       +0.j],</span>
<span class="sd">[ 0.       +0.j, 0.4330127+0.j]]]]</span>
<span class="sd">&lt;QTensor [2, 2, 2, 2] DEV_CPU kcomplex128&gt;</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-qsvt">
<h3>VQC_QSVT<a class="headerlink" href="#vqc-qsvt" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.VQC_QSVT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">VQC_QSVT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wires</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.VQC_QSVT" title="Link to this definition">¶</a></dt>
<dd><p>实现
<a class="reference external" href="https://arxiv.org/abs/1806.01838">quantum singular value transformation</a> (QSVT) 线路.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> – 要编码的一般 <span class="math notranslate nohighlight">\((n \times m)\)</span> 矩阵。</p></li>
<li><p><strong>angles</strong> – 构建QSVT多项式的偏移系数。</p></li>
<li><p><strong>wires</strong> – A 作用于的量子比特索引。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">DEV_GPU</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span><span class="n">VQC_QSVT</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.dtype</span><span class="w"> </span><span class="kn">import</span> <span class="n">float_dtype_to_complex_dtype</span><span class="p">,</span><span class="n">kfloat64</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]])</span>
<span class="n">angles</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
<span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">float_dtype_to_complex_dtype</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>
<span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">qf</span> <span class="o">=</span> <span class="n">VQC_QSVT</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">angles</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">z1</span> <span class="o">=</span> <span class="n">qf</span><span class="p">(</span><span class="n">qm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z1</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">[[[[[ 0.9645935+0.2352667j,-0.0216623+0.0512362j],</span>
<span class="sd">[-0.0062613+0.0308878j,-0.0199871+0.0985996j]],</span>

<span class="sd">[[ 0.       +0.j       , 0.       +0.j       ],</span>
<span class="sd">    [ 0.       +0.j       , 0.       +0.j       ]]],</span>


<span class="sd">[[[ 0.       +0.j       , 0.       +0.j       ],</span>
<span class="sd">    [ 0.       +0.j       , 0.       +0.j       ]],</span>

<span class="sd">[[ 0.       +0.j       , 0.       +0.j       ],</span>
<span class="sd">    [ 0.       +0.j       , 0.       +0.j       ]]]]]</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="id45">
<h2>量子机器学习模型接口<a class="headerlink" href="#id45" title="Link to this heading">¶</a></h2>
<section id="quanvolution">
<h3>Quanvolution<a class="headerlink" href="#quanvolution" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.qcnn.Quanvolution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.qcnn.</span></span><span class="sig-name descname"><span class="pre">Quanvolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">quantum_uniform</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">machine_type_or_cloud_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.qcnn.Quanvolution" title="Link to this definition">¶</a></dt>
<dd><p>基于《Quanvolutional Neural Networks: Powering Image Recognition with Quantum Circuits》（<a class="reference external" href="https://arxiv.org/abs/1904.04767">https://arxiv.org/abs/1904.04767</a>）实现的量子卷积，用变分量子电路替换经典的卷积滤波器，从而得到具有量子卷积滤波器的量子卷积神经网络。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params_shape</strong> – 参数的形状，应为二维。</p></li>
<li><p><strong>strides</strong> – 切片窗口的步长，默认为 (1,1)。</p></li>
<li><p><strong>kernel_initializer</strong> – 参数的卷积核初始化器。</p></li>
<li><p><strong>machine_type_or_cloud_token</strong> – 机器类型字符串或 Qcloud 令牌，默认为“cpu”。</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.qcnn</span><span class="w"> </span><span class="kn">import</span> <span class="n">Quanvolution</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tensor</span>
<span class="n">qlayer</span> <span class="o">=</span> <span class="n">Quanvolution</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">],(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span><span class="o">*</span><span class="mi">25</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">25</span><span class="p">])</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">qlayer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">y</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">qlayer</span><span class="o">.</span><span class="n">m_para</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qlayer</span><span class="o">.</span><span class="n">m_para</span><span class="o">.</span><span class="n">grad</span><span class="p">)</span>
<span class="c1">#[3, 4, 8, 8]</span>

<span class="c1">#[4.0270405,4.3587413,2.4935627,2.8155506,0.3314773,0.8889271,3.7357519, 0.9196261]</span>
<span class="c1">#&lt;Parameter [8] DEV_CPU kfloat32&gt;</span>

<span class="c1">#[ -0.2364242, -0.6942478, -8.445061 , -0.0558891, -0.       ,-49.498577 ,40.339344 , 40.339344 ]</span>
<span class="c1">#&lt;QTensor [8] DEV_CPU kfloat32&gt;</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="qdrl">
<h3>QDRL<a class="headerlink" href="#qdrl" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.qdrl_vqc.QDRL">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.qdrl_vqc.</span></span><span class="sig-name descname"><span class="pre">QDRL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.qdrl_vqc.QDRL" title="Link to this definition">¶</a></dt>
<dd><p>基于《Data re-uploading for a universal quantum classifier》（<a class="reference external" href="https://arxiv.org/abs/1907.02085">https://arxiv.org/abs/1907.02085</a>）实现的量子数据重上传(Quantum Data Re-upLoading,QDRL)算法是一种将量子电路与经典神经网络相结合的量子数据重上传模型。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nq</strong> – 量子电路中所使用的量子比特（qubits的数量）。这决定了模型将要处理的量子系统的规模。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.dtype</span><span class="w"> </span><span class="kn">import</span> <span class="n">kcomplex64</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.qdrl_vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QDRL</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tensor</span>

<span class="c1"># Set the number of quantum bits (qubits)</span>
<span class="n">nq</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Initialize the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">QDRL</span><span class="p">(</span><span class="n">nq</span><span class="p">)</span>

<span class="c1"># Create an example input (assume the input is a (batch_size, 3) shaped data)</span>
<span class="c1"># Suppose we have a batch_size of 4 and each input has 3 features</span>
<span class="n">x_input</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">kcomplex64</span><span class="p">)</span>

<span class="c1"># Pass the input through the model</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x_input</span><span class="p">)</span>

<span class="n">output</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>

<span class="c1"># Output the result</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model output:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="qgru">
<h3>QGRU<a class="headerlink" href="#qgru" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.qgru.QGRU">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.qgru.</span></span><span class="sig-name descname"><span class="pre">QGRU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">para_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_of_qubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.qgru.QGRU" title="Link to this definition">¶</a></dt>
<dd><p>量子版的GRU（门控循环单元），通过利用量子电路来进行状态更新和记忆保持。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>para_num</strong> – 量子电路中的参数数量。</p></li>
<li><p><strong>num_of_qubits</strong> – 量子比特的数量。</p></li>
<li><p><strong>input_size</strong> – 输入数据的特征维度。</p></li>
<li><p><strong>hidden_size</strong> – 隐藏单元的维度。</p></li>
<li><p><strong>batch_first</strong> – 输入的第一维是否为批次数量。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.qgru</span><span class="w"> </span><span class="kn">import</span> <span class="n">QGRU</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.dtype</span><span class="w"> </span><span class="kn">import</span> <span class="n">kfloat32</span>
<span class="c1"># Example usage</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Set parameters</span>
    <span class="n">para_num</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">num_of_qubits</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">input_size</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">hidden_size</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">seq_length</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c1"># Create QGRU model</span>
    <span class="n">qgru</span> <span class="o">=</span> <span class="n">QGRU</span><span class="p">(</span><span class="n">para_num</span><span class="p">,</span> <span class="n">num_of_qubits</span><span class="p">,</span> <span class="n">input_size</span><span class="p">,</span> <span class="n">hidden_size</span><span class="p">,</span> <span class="n">batch_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Create input data</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">seq_length</span><span class="p">,</span> <span class="n">input_size</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">kfloat32</span><span class="p">)</span>

    <span class="c1"># Call the model</span>
    <span class="n">output</span><span class="p">,</span> <span class="n">h_t</span> <span class="o">=</span> <span class="n">qgru</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">output</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output shape:&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Output shape</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;h_t shape:&quot;</span><span class="p">,</span> <span class="n">h_t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Final hidden state shape</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="qlinear">
<h3>QLinear<a class="headerlink" href="#qlinear" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.qlinear.QLinear">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.qlinear.</span></span><span class="sig-name descname"><span class="pre">QLinear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nput_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">machine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.qlinear.QLinear" title="Link to this definition">¶</a></dt>
<dd><p>QLinear 实现了一种量子全连接算法。首先将数据编码到量子态,然后通过量子线路进行演化操作和测量得到最终的全连接结果。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_channels</strong> – 输入通道数。</p></li>
<li><p><strong>output_channels</strong> – 输出通道数。</p></li>
<li><p><strong>machine</strong> – 使用的虚拟机,默认使用CPU模拟。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.qlinear</span><span class="w"> </span><span class="kn">import</span> <span class="n">QLinear</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.37454012</span><span class="p">,</span> <span class="mf">0.95071431</span><span class="p">,</span> <span class="mf">0.73199394</span><span class="p">,</span> <span class="mf">0.59865848</span><span class="p">,</span> <span class="mf">0.15601864</span><span class="p">,</span> <span class="mf">0.15599452</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1.37454012</span><span class="p">,</span> <span class="mf">0.95071431</span><span class="p">,</span> <span class="mf">0.73199394</span><span class="p">,</span> <span class="mf">0.59865848</span><span class="p">,</span> <span class="mf">0.15601864</span><span class="p">,</span> <span class="mf">0.15599452</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1.37454012</span><span class="p">,</span> <span class="mf">1.95071431</span><span class="p">,</span> <span class="mf">0.73199394</span><span class="p">,</span> <span class="mf">0.59865848</span><span class="p">,</span> <span class="mf">0.15601864</span><span class="p">,</span> <span class="mf">0.15599452</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1.37454012</span><span class="p">,</span> <span class="mf">1.95071431</span><span class="p">,</span> <span class="mf">1.73199394</span><span class="p">,</span> <span class="mf">1.59865848</span><span class="p">,</span> <span class="mf">0.15601864</span><span class="p">,</span> <span class="mf">0.15599452</span><span class="p">]]</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">QLinear</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="n">output</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="c1">#[</span>
<span class="c1">#[0.0568473, 0.1264389],</span>
<span class="c1">#[0.1524036, 0.1264389],</span>
<span class="c1">#[0.1524036, 0.1442845],</span>
<span class="c1">#[0.1524036, 0.1442845]</span>
<span class="c1">#]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="qlstm">
<h3>QLSTM<a class="headerlink" href="#qlstm" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.qlstm.QLSTM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.qlstm.</span></span><span class="sig-name descname"><span class="pre">QLSTM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">para_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_of_qubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.qlstm.QLSTM" title="Link to this definition">¶</a></dt>
<dd><p>QLSTM (Quantum Long Short-Term Memory) 是一种结合了量子计算和经典LSTM的混合模型，旨在利用量子计算的并行性和经典LSTM的记忆能力来处理序列数据。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>para_num</strong> – 量子电路中的参数数量。</p></li>
<li><p><strong>num_of_qubits</strong> – 量子比特的数量。</p></li>
<li><p><strong>input_size</strong> – 输入数据的特征维度。</p></li>
<li><p><strong>hidden_size</strong> – 隐藏单元的维度。</p></li>
<li><p><strong>batch_first</strong> – 输入的第一维是否为批次数量。</p></li>
</ul>
</dd>
</dl>
<p>Examnple:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.qlstm</span><span class="w"> </span><span class="kn">import</span> <span class="n">QLSTM</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.dtype</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">para_num</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">num_of_qubits</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">input_size</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">hidden_size</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">seq_length</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">qlstm</span> <span class="o">=</span> <span class="n">QLSTM</span><span class="p">(</span><span class="n">para_num</span><span class="p">,</span> <span class="n">num_of_qubits</span><span class="p">,</span> <span class="n">input_size</span><span class="p">,</span> <span class="n">hidden_size</span><span class="p">,</span> <span class="n">batch_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">seq_length</span><span class="p">,</span> <span class="n">input_size</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">kfloat32</span><span class="p">)</span>

    <span class="n">output</span><span class="p">,</span> <span class="p">(</span><span class="n">h_t</span><span class="p">,</span> <span class="n">c_t</span><span class="p">)</span> <span class="o">=</span> <span class="n">qlstm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output shape:&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;h_t shape:&quot;</span><span class="p">,</span> <span class="n">h_t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;c_t shape:&quot;</span><span class="p">,</span> <span class="n">c_t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="qmlpmodel">
<h3>QMLPModel<a class="headerlink" href="#qmlpmodel" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.qmlp.qmlp.QMLPModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.qmlp.qmlp.</span></span><span class="sig-name descname"><span class="pre">QMLPModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_qubits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_size_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_size_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_padding_type</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'valid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_initializer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_initializer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.qmlp.qmlp.QMLPModel" title="Link to this definition">¶</a></dt>
<dd><p>《QMLP: An Error-Tolerant Nonlinear Quantum MLP Architecture using Parameterized Two-Qubit Gates》是一种量子启发式神经网络，QMLPModel将量子电路与经典神经网络操作（如池化和全连接层）相结合。它旨在处理量子数据，并通过量子操作和经典层提取相关特征。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_channels</strong> – 输入特征的数量。</p></li>
<li><p><strong>output_channels</strong> – 输出特征的数量。</p></li>
<li><p><strong>num_qubits</strong> – 量子比特的数量。</p></li>
<li><p><strong>kernel</strong> – 平均池化窗口的大小。</p></li>
<li><p><strong>stride</strong> – 下采样的步长因子。</p></li>
<li><p><strong>padding</strong> – 填充方式，可选“valid”或“same”。</p></li>
<li><p><strong>weight_initializer</strong> – 权重初始化器，默认为正态分布。</p></li>
<li><p><strong>bias_initializer</strong> – 偏置初始化器，默认为零初始化。</p></li>
<li><p><strong>use_bias</strong> – 是否使用偏置，默认为True。</p></li>
<li><p><strong>dtype</strong> – 默认为None，使用默认数据类型。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.qmlp.qmlp</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMLPModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.dtype</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="n">input_channels</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">output_channels</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">num_qubits</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">stride</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">padding</span> <span class="o">=</span> <span class="s2">&quot;valid&quot;</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">8</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">QMLPModel</span><span class="p">(</span><span class="n">input_channels</span><span class="o">=</span><span class="n">num_qubits</span><span class="p">,</span>
                  <span class="n">output_channels</span><span class="o">=</span><span class="n">output_channels</span><span class="p">,</span>
                  <span class="n">num_qubits</span><span class="o">=</span><span class="n">num_qubits</span><span class="p">,</span>
                  <span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span>
                  <span class="n">stride</span><span class="o">=</span><span class="n">stride</span><span class="p">,</span>
                  <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">input_channels</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">kfloat32</span><span class="p">)</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output shape:&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="qrlmodel">
<h3>QRLModel<a class="headerlink" href="#qrlmodel" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.qrl.QRLModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.qrl.</span></span><span class="sig-name descname"><span class="pre">QRLModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_qubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.qrl.QRLModel" title="Link to this definition">¶</a></dt>
<dd><p>使用变分量子电路的量子深度强化学习模型。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_qubits</strong> – 量子电路中所使用的量子比特的数量。</p></li>
<li><p><strong>n_layers</strong> – 变分量子电路中的层数。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span><span class="p">,</span> <span class="n">QTensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.qrl</span><span class="w"> </span><span class="kn">import</span> <span class="n">QRLModel</span>

<span class="n">num_qubits</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">QRLModel</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="n">num_qubits</span><span class="p">,</span> <span class="n">n_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]])</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">output</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model output:&quot;</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="qrnn">
<h3>QRNN<a class="headerlink" href="#qrnn" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.qrnn.QRNN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.qrnn.</span></span><span class="sig-name descname"><span class="pre">QRNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">para_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_of_qubits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.qrnn.QRNN" title="Link to this definition">¶</a></dt>
<dd><p>QRNN（Quantum Recurrent Neural Network）是一种量子循环神经网络，旨在处理序列数据并捕捉序列中的长期依赖关系。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>para_num</strong> – 量子电路中的参数数量。</p></li>
<li><p><strong>num_of_qubits</strong> – 量子比特的数量。</p></li>
<li><p><strong>input_size</strong> – 输入数据的特征维度。</p></li>
<li><p><strong>hidden_size</strong> – 隐藏单元的维度。</p></li>
<li><p><strong>batch_first</strong> – 输入的第一维是否为批次数量,默认为True。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.dtype</span><span class="w"> </span><span class="kn">import</span> <span class="n">kfloat32</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.qrnn</span><span class="w"> </span><span class="kn">import</span> <span class="n">QRNN</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span><span class="p">,</span> <span class="n">QTensor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">para_num</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">num_of_qubits</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">input_size</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">hidden_size</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">seq_length</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">qrnn</span> <span class="o">=</span> <span class="n">QRNN</span><span class="p">(</span><span class="n">para_num</span><span class="p">,</span> <span class="n">num_of_qubits</span><span class="p">,</span> <span class="n">input_size</span><span class="p">,</span> <span class="n">hidden_size</span><span class="p">,</span> <span class="n">batch_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">seq_length</span><span class="p">,</span> <span class="n">input_size</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">kfloat32</span><span class="p">)</span>

    <span class="n">output</span><span class="p">,</span> <span class="n">h_t</span> <span class="o">=</span> <span class="n">qrnn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output shape:&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;h_t shape:&quot;</span><span class="p">,</span> <span class="n">h_t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="ttolayer">
<h3>TTOLayer<a class="headerlink" href="#ttolayer" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.ttolayer.TTOLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.ttolayer.</span></span><span class="sig-name descname"><span class="pre">TTOLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp_modes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_modes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat_ranks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cores_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nn.init.xavier_uniform_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cores_regularizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biases_initializer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.zeros</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biases_regularizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpu_variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.ttolayer.TTOLayer" title="Link to this definition">¶</a></dt>
<dd><p>基于《Compressing deep neural networks by matrix product operators》（<a class="reference external" href="https://arxiv.org/abs/1904.06194">https://arxiv.org/abs/1904.06194</a>）实现的TTOLayer对输入张量进行分解，从而实现对高维数据的高效表示。该层允许在秩约束条件下学习张量分解，相比于传统的全连接层，能够降低计算复杂度和内存使用。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inp_modes</strong> – 输入张量的维度。</p></li>
<li><p><strong>out_modes</strong> – 输出张量的维度。</p></li>
<li><p><strong>mat_ranks</strong> – 张量分解中张量核（分解秩）的秩。</p></li>
<li><p><strong>cores_initializer</strong> – 张量核的初始化函数。</p></li>
<li><p><strong>cores_regularizer</strong> – 默认为None,张量核的正则化函数。</p></li>
<li><p><strong>biases_initializer</strong> – 偏置的初始化函数。</p></li>
<li><p><strong>biases_regularizer</strong> – 默认为None,偏置的正则化函数。</p></li>
<li><p><strong>trainable</strong> – 默认为True,指示参数（张量核和偏置）是否可训练。</p></li>
<li><p><strong>cpu_variables</strong> – 默认为False,指示变量（张量核和偏置）是否应存储在CPU上而不是GPU上。如果使用CPU存储，则设置为True。</p></li>
<li><p><strong>scope</strong> – 默认为None,个可选的层范围或名称，用于模型组织或在处理大型模型时进行跟踪。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.ttolayer</span><span class="w"> </span><span class="kn">import</span> <span class="n">TTOLayer</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">inp_modes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">out_modes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">mat_ranks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">tto_layer</span> <span class="o">=</span> <span class="n">TTOLayer</span><span class="p">(</span><span class="n">inp_modes</span><span class="p">,</span> <span class="n">out_modes</span><span class="p">,</span> <span class="n">mat_ranks</span><span class="p">)</span>

<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">len</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">embed_size</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">,</span> <span class="n">embed_size</span><span class="p">)</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">tto_layer</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input shape:&quot;</span><span class="p">,</span> <span class="n">inp</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output shape:&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn_like</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="n">loss_fn</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loss:&quot;</span><span class="p">,</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

<span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">tto_layer</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">grad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gradient for </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">param</span><span class="o">.</span><span class="n">grad</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No gradient for </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="id46">
<h2>其他函数<a class="headerlink" href="#id46" title="Link to this heading">¶</a></h2>
<section id="quantumlayeradjoint">
<h3>QuantumLayerAdjoint<a class="headerlink" href="#quantumlayeradjoint" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.QuantumLayerAdjoint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">QuantumLayerAdjoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">general_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pyvqnet.nn.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.QuantumLayerAdjoint" title="Link to this definition">¶</a></dt>
<dd><p>使用伴随矩阵方式进行梯度计算的可自动微分的QuantumLayer层,参考  <a class="reference external" href="https://arxiv.org/abs/2009.02823">Efficient calculation of gradients in classical simulations of variational quantum algorithms</a> 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>general_module</strong> – 一个仅使用 <code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc</span></code> 下量子线路接口搭建的 <cite>pyvqnet.nn.Module</cite> 实例。</p></li>
<li><p><strong>use_qpanda</strong> – 是否使用qpanda线路进行前传,默认:False。</p></li>
<li><p><strong>name</strong> – 该层名字,默认为””。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>返回一个 QuantumLayerAdjoint 类实例。</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>general_module 的 QMachine 应设置 grad_method = “adjoint”.</p>
<p>当前支持由如下含参逻辑门 <cite>RX</cite>, <cite>RY</cite>, <cite>RZ</cite>, <cite>PhaseShift</cite>, <cite>RXX</cite>, <cite>RYY</cite>, <cite>RZZ</cite>, <cite>RZX</cite>, <cite>U1</cite>, <cite>U2</cite>, <cite>U3</cite> 以及其他不含参逻辑门构成的变分线路。</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuantumLayerAdjoint</span><span class="p">,</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">RX</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">CNOT</span><span class="p">,</span> <span class="n">PauliX</span><span class="p">,</span> <span class="n">qmatrix</span><span class="p">,</span> <span class="n">PauliZ</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">MeasureAll</span><span class="p">,</span> <span class="n">RZ</span><span class="p">,</span> <span class="n">VQC_RotCircuit</span><span class="p">,</span> <span class="n">VQC_HardwareEfficientAnsatz</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">set_random_seed</span>

<span class="n">set_random_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">QModel</span><span class="p">(</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">grad_mode</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_wires</span> <span class="o">=</span> <span class="n">num_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">grad_mode</span><span class="o">=</span><span class="n">grad_mode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rx_layer</span> <span class="o">=</span> <span class="n">RX</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ry_layer</span> <span class="o">=</span> <span class="n">RY</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer2</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rot</span> <span class="o">=</span> <span class="n">VQC_HardwareEfficientAnsatz</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;rx&quot;</span><span class="p">,</span> <span class="s2">&quot;RY&quot;</span><span class="p">,</span> <span class="s2">&quot;rz&quot;</span><span class="p">],</span>
                                            <span class="n">entangle_gate</span><span class="o">=</span><span class="s2">&quot;cnot&quot;</span><span class="p">,</span>
                                            <span class="n">entangle_rules</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
                                            <span class="n">depth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tlayer</span> <span class="o">=</span> <span class="n">T</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnot</span> <span class="o">=</span> <span class="n">CNOT</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;wires&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s1">&#39;observables&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
            <span class="s1">&#39;coefficient&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">})</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rx_layer</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ry_layer</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tlayer</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer2</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="n">rlt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rlt</span>


<span class="n">input_x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]])</span>

<span class="n">input_x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">input_x</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">input_x</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">qunatum_model</span> <span class="o">=</span> <span class="n">QModel</span><span class="p">(</span><span class="n">num_wires</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex64</span><span class="p">,</span>
                    <span class="n">grad_mode</span><span class="o">=</span><span class="s2">&quot;adjoint&quot;</span><span class="p">)</span>

<span class="n">adjoint_model</span> <span class="o">=</span> <span class="n">QuantumLayerAdjoint</span><span class="p">(</span><span class="n">qunatum_model</span><span class="p">,</span><span class="n">q_machine</span><span class="o">=</span><span class="n">qunatum_model</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>

<span class="n">batch_y</span> <span class="o">=</span> <span class="n">adjoint_model</span><span class="p">(</span><span class="n">input_x</span><span class="p">)</span>
<span class="n">batch_y</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">batch_y</span><span class="p">)</span>
<span class="c1"># [[-0.0778451],</span>
<span class="c1">#  [-0.0778451],</span>
<span class="c1">#  [-0.0778451],</span>
<span class="c1">#  [-0.0778451]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="quantumlayeres">
<h3>QuantumLayerES<a class="headerlink" href="#quantumlayeres" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.QuantumLayerES">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">QuantumLayerES</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">general_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">nn.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_machine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyvqnet.qnn.vqc.QMachine" title="pyvqnet.qnn.vqc.QMachine"><span class="pre">pyvqnet.qnn.vqc.QMachine</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">np.pi</span> <span class="pre">/</span> <span class="pre">24</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.QuantumLayerES" title="Link to this definition">¶</a></dt>
<dd><p>根据进化策略进行梯度计算的可自动微分的QuantumLayer层,参考  <a class="reference external" href="https://arxiv.org/abs/2310.17402">Learning to learn with an evolutionary strategy Learning to learn with an evolutionary strategy</a> 。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>general_module</strong> – 一个仅使用 <code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc</span></code> 下量子线路接口搭建的 <cite>pyvqnet.nn.QModule</cite> 实例。</p></li>
<li><p><strong>q_machine</strong> – 来自general_module中定义的QMachine。</p></li>
<li><p><strong>name</strong> – 该层名字,默认为””。</p></li>
<li><p><strong>sigma</strong> – 多元正态分布的采样方差.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>general_module 的 QMachine 应设置 grad_method = “ES”.</p>
<p>当前支持由如下含参逻辑门 <cite>RX</cite>, <cite>RY</cite>, <cite>RZ</cite>, <cite>PhaseShift</cite>, <cite>RXX</cite>, <cite>RYY</cite>, <cite>RZZ</cite>, <cite>RZX</cite>, <cite>U1</cite>, <cite>U2</cite>, <cite>U3</cite> 以及其他不含参逻辑门构成的变分线路。</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuantumLayerES</span><span class="p">,</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">RX</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">CNOT</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">MeasureAll</span><span class="p">,</span> <span class="n">RZ</span><span class="p">,</span> <span class="n">VQC_HardwareEfficientAnsatz</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">set_random_seed</span>

<span class="n">set_random_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">QModel</span><span class="p">(</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">grad_mode</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_wires</span> <span class="o">=</span> <span class="n">num_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">grad_mode</span><span class="o">=</span><span class="n">grad_mode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rx_layer</span> <span class="o">=</span> <span class="n">RX</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ry_layer</span> <span class="o">=</span> <span class="n">RY</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer2</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rot</span> <span class="o">=</span> <span class="n">VQC_HardwareEfficientAnsatz</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;rx&quot;</span><span class="p">,</span> <span class="s2">&quot;RY&quot;</span><span class="p">,</span> <span class="s2">&quot;rz&quot;</span><span class="p">],</span>
                                            <span class="n">entangle_gate</span><span class="o">=</span><span class="s2">&quot;cnot&quot;</span><span class="p">,</span>
                                            <span class="n">entangle_rules</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
                                            <span class="n">depth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tlayer</span> <span class="o">=</span> <span class="n">T</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnot</span> <span class="o">=</span> <span class="n">CNOT</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;wires&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s1">&#39;observables&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
            <span class="s1">&#39;coefficient&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">})</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rx_layer</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ry_layer</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tlayer</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer2</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="n">rlt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rlt</span>


<span class="n">input_x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]])</span>

<span class="n">input_x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">input_x</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">input_x</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">qunatum_model</span> <span class="o">=</span> <span class="n">QModel</span><span class="p">(</span><span class="n">num_wires</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex64</span><span class="p">,</span>
                    <span class="n">grad_mode</span><span class="o">=</span><span class="s2">&quot;ES&quot;</span><span class="p">)</span>

<span class="n">ES_model</span> <span class="o">=</span> <span class="n">QuantumLayerES</span><span class="p">(</span><span class="n">qunatum_model</span><span class="p">,</span> <span class="n">qunatum_model</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>

<span class="n">batch_y</span> <span class="o">=</span> <span class="n">ES_model</span><span class="p">(</span><span class="n">input_x</span><span class="p">)</span>
<span class="n">batch_y</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">batch_y</span><span class="p">)</span>
<span class="c1"># [[-0.0778451],</span>
<span class="c1">#  [-0.0778451],</span>
<span class="c1">#  [-0.0778451],</span>
<span class="c1">#  [-0.0778451]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="dataparallelvqcadjointlayer">
<h3>DataParallelVQCAdjointLayer<a class="headerlink" href="#dataparallelvqcadjointlayer" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.distributed.DataParallelVQCAdjointLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.distributed.</span></span><span class="sig-name descname"><span class="pre">DataParallelVQCAdjointLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Comm_OP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vqc_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.distributed.DataParallelVQCAdjointLayer" title="Link to this definition">¶</a></dt>
<dd><p>使用数据并行对数据批次大小创建 vqc 使用伴随梯度计算。其中 <code class="docutils literal notranslate"><span class="pre">vqc_module</span></code> 必须为 <code class="docutils literal notranslate"><span class="pre">QuantumLayerAdjoint</span></code> 类型的VQC模块.
如果我们使用 N 个节点来运行此模块,
在每个节点中, <cite>batch_size/N</cite> 数据向前运行变分量子线路 计算梯度。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Comm_OP</strong> – 设置分布式环境的通信控制器。</p></li>
<li><p><strong>vqc_module</strong> – 带有 forward() 的 QuantumLayerAdjoint类型的VQC模块,确保qmachine 已正确设置。</p></li>
<li><p><strong>name</strong> – 模块的名称。默认值为空字符串。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>可以计算量子电路的模块。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#mpirun -n 2 python test.py</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;../../&quot;</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.distributed</span><span class="w"> </span><span class="kn">import</span> <span class="n">CommController</span><span class="p">,</span><span class="n">DataParallelVQCAdjointLayer</span><span class="p">,</span>\
<span class="n">get_local_rank</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.nn</span><span class="w"> </span><span class="kn">import</span> <span class="n">Module</span><span class="p">,</span> <span class="n">Linear</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.device</span><span class="w"> </span><span class="kn">import</span> <span class="n">DEV_GPU_0</span>

<span class="n">bsize</span> <span class="o">=</span> <span class="mi">100</span>


<span class="k">class</span><span class="w"> </span><span class="nc">QModel</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">grad_mode</span><span class="o">=</span><span class="s2">&quot;adjoint&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_wires</span> <span class="o">=</span> <span class="n">num_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">grad_mode</span><span class="o">=</span><span class="n">grad_mode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rx_layer</span> <span class="o">=</span> <span class="n">RX</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ry_layer</span> <span class="o">=</span> <span class="n">RY</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u1</span> <span class="o">=</span> <span class="n">U1</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u2</span> <span class="o">=</span> <span class="n">U2</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u3</span> <span class="o">=</span> <span class="n">U3</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="n">I</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x1</span> <span class="o">=</span> <span class="n">X1</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y1</span> <span class="o">=</span> <span class="n">Y1</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z1</span> <span class="o">=</span> <span class="n">Z1</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">PauliX</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">PauliY</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">PauliZ</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">swap</span> <span class="o">=</span> <span class="n">SWAP</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cz</span> <span class="o">=</span> <span class="n">CZ</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cr</span> <span class="o">=</span> <span class="n">CR</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rxx</span> <span class="o">=</span> <span class="n">RXX</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rzz</span> <span class="o">=</span> <span class="n">RYY</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ryy</span> <span class="o">=</span> <span class="n">RZZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rzx</span> <span class="o">=</span> <span class="n">RZX</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toffoli</span> <span class="o">=</span> <span class="n">Toffoli</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">use_dagger</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">Hadamard</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">iSWAP</span> <span class="o">=</span> <span class="n">iSWAP</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tlayer</span> <span class="o">=</span> <span class="n">T</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnot</span> <span class="o">=</span> <span class="n">CNOT</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Z0&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y1</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z1</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ryy</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rxx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rzz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rzx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">u1</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u2</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u3</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rx_layer</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iSWAP</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ry_layer</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tlayer</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toffoli</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="n">rlt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rlt</span>


<span class="n">pyvqnet</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="n">Comm_OP</span> <span class="o">=</span> <span class="n">CommController</span><span class="p">(</span><span class="s2">&quot;mpi&quot;</span><span class="p">)</span>

<span class="n">input_x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]])</span>
<span class="n">input_x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">input_x</span><span class="p">,</span> <span class="p">[</span><span class="n">bsize</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">input_x</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">qunatum_model</span> <span class="o">=</span> <span class="n">QModel</span><span class="p">(</span><span class="n">num_wires</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex64</span><span class="p">)</span>

<span class="n">l</span> <span class="o">=</span> <span class="n">DataParallelVQCAdjointLayer</span><span class="p">(</span>
    <span class="n">Comm_OP</span><span class="p">,</span>
    <span class="n">qunatum_model</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">l</span><span class="p">(</span><span class="n">input_x</span><span class="p">)</span>

<span class="n">y</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="dataparallelvqclayer">
<h3>DataParallelVQCLayer<a class="headerlink" href="#dataparallelvqclayer" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.distributed.DataParallelVQCLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.distributed.</span></span><span class="sig-name descname"><span class="pre">DataParallelVQCLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Comm_OP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vqc_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.distributed.DataParallelVQCLayer" title="Link to this definition">¶</a></dt>
<dd><p>使用数据并行对数据批次大小创建 vqc 使用自动微分计算。
如果我们使用 N 个节点来运行此模块,
在每个节点中, <cite>batch_size/N</cite> 数据向前运行变分量子线路 计算梯度。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Comm_OP</strong> – 设置分布式环境的通信控制器。</p></li>
<li><p><strong>vqc_module</strong> – 带有 forward() 的 VQC模块,确保qmachine 已正确设置。</p></li>
<li><p><strong>name</strong> – 模块的名称。默认值为空字符串。</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>可以计算量子电路的模块。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#mpirun -n 2 python xxx.py</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.backends</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">cnot</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">rz</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">MeasureAll</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.distributed</span><span class="w"> </span><span class="kn">import</span> <span class="n">CommController</span><span class="p">,</span> <span class="n">DataParallelVQCLayer</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.nn</span><span class="w"> </span><span class="kn">import</span> <span class="n">Module</span><span class="p">,</span> <span class="n">Linear</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.device</span><span class="w"> </span><span class="kn">import</span> <span class="n">DEV_GPU_0</span>


<span class="k">class</span><span class="w"> </span><span class="nc">QModel</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_wires</span><span class="p">,</span> <span class="n">num_layer</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">grad_mode</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_wires</span> <span class="o">=</span> <span class="n">num_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">grad_mode</span><span class="o">=</span><span class="n">grad_mode</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">PauliX</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">num_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span> <span class="o">=</span> <span class="n">num_layer</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span>
        <span class="n">qm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qm</span>
        <span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
            <span class="n">cnot</span><span class="p">(</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">l</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="n">rx</span><span class="p">(</span><span class="n">qm</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span><span class="p">[:,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="n">i</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="n">rz</span><span class="p">(</span><span class="n">qm</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span><span class="p">[:,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="n">n</span><span class="p">],</span> <span class="n">i</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="n">rx</span><span class="p">(</span><span class="n">qm</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span><span class="p">[:,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n</span><span class="p">],</span> <span class="n">i</span><span class="p">)</span>

        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">qm</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">y</span>


<span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">l</span> <span class="o">=</span> <span class="mi">2</span>

<span class="nb">input</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">b</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">l</span><span class="p">])</span>

<span class="n">Comm</span> <span class="o">=</span> <span class="n">CommController</span><span class="p">(</span><span class="s2">&quot;mpi&quot;</span><span class="p">)</span>

<span class="nb">input</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">qunatum_model</span> <span class="o">=</span> <span class="n">QModel</span><span class="p">(</span><span class="n">num_wires</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">num_layer</span><span class="o">=</span><span class="n">l</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex64</span><span class="p">)</span>

<span class="n">layer</span> <span class="o">=</span> <span class="n">qunatum_model</span>

<span class="n">layer</span> <span class="o">=</span> <span class="n">DataParallelVQCLayer</span><span class="p">(</span>
    <span class="n">Comm</span><span class="p">,</span>
    <span class="n">qunatum_model</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="vqc-to-originir-list">
<h3>vqc_to_originir_list<a class="headerlink" href="#vqc-to-originir-list" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.vqc_to_originir_list">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">vqc_to_originir_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vqc_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pyvqnet.nn.Module</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.vqc_to_originir_list" title="Link to this definition">¶</a></dt>
<dd><p>将 VQNet vqc 模块转换为 <a class="reference external" href="https://qpanda-tutorial.readthedocs.io/zh/latest/QProgToOriginIR.html#id2">originIR</a> 。</p>
<p>vqc_model 应在此函数之前运行前向函数以获取输入数据。
如果输入数据是批量数据。 对于每个输入,它将返回多个 IR 字符串。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vqc_model</strong> – VQNet vqc 模块,应该先向前运行。</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>originIR 字符串或 originIR 字符串列表。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.nn</span><span class="w"> </span><span class="kn">import</span> <span class="n">Module</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">set_random_seed</span>
<span class="n">set_random_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">QModel</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span><span class="n">grad_mode</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_wires</span> <span class="o">=</span> <span class="n">num_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span><span class="n">grad_mode</span><span class="o">=</span><span class="n">grad_mode</span><span class="p">,</span><span class="n">save_ir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rx_layer</span> <span class="o">=</span> <span class="n">RX</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ry_layer</span> <span class="o">=</span> <span class="n">RY</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u1</span> <span class="o">=</span> <span class="n">U1</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u2</span> <span class="o">=</span> <span class="n">U2</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u3</span> <span class="o">=</span> <span class="n">U3</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="n">I</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x1</span> <span class="o">=</span> <span class="n">X1</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y1</span> <span class="o">=</span> <span class="n">Y1</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z1</span> <span class="o">=</span> <span class="n">Z1</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">PauliX</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">PauliY</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">PauliZ</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">swap</span> <span class="o">=</span> <span class="n">SWAP</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cz</span> <span class="o">=</span> <span class="n">CZ</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cr</span> <span class="o">=</span> <span class="n">CR</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rxx</span> <span class="o">=</span> <span class="n">RXX</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rzz</span> <span class="o">=</span> <span class="n">RYY</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ryy</span> <span class="o">=</span> <span class="n">RZZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rzx</span> <span class="o">=</span> <span class="n">RZX</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toffoli</span> <span class="o">=</span> <span class="n">Toffoli</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="n">use_dagger</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#self.rz_layer2 = RZ(has_params=True, trainable=True, wires=1)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span><span class="n">Hadamard</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rot</span> <span class="o">=</span> <span class="n">VQC_HardwareEfficientAnsatz</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;rx&quot;</span><span class="p">,</span> <span class="s2">&quot;RY&quot;</span><span class="p">,</span> <span class="s2">&quot;rz&quot;</span><span class="p">],</span>
                                            <span class="n">entangle_gate</span><span class="o">=</span><span class="s2">&quot;cnot&quot;</span><span class="p">,</span>
                                            <span class="n">entangle_rules</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
                                            <span class="n">depth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">iSWAP</span> <span class="o">=</span> <span class="n">iSWAP</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tlayer</span> <span class="o">=</span> <span class="n">T</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnot</span> <span class="o">=</span> <span class="n">CNOT</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;wires&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s1">&#39;observables&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
            <span class="s1">&#39;coefficient&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">})</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y1</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z1</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ryy</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rxx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rzz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rzx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">params</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cr</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u1</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u2</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u3</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rx_layer</span><span class="p">(</span><span class="n">params</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iSWAP</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ry_layer</span><span class="p">(</span><span class="n">params</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tlayer</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer</span><span class="p">(</span><span class="n">params</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toffoli</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="n">rlt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rlt</span>


<span class="n">input_x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]])</span>

<span class="n">input_x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">input_x</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

<span class="n">input_x</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">qunatum_model</span> <span class="o">=</span> <span class="n">QModel</span><span class="p">(</span><span class="n">num_wires</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex64</span><span class="p">)</span>

<span class="n">batch_y</span> <span class="o">=</span> <span class="n">qunatum_model</span><span class="p">(</span><span class="n">input_x</span><span class="p">)</span>
<span class="n">batch_y</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="n">ll</span> <span class="o">=</span> <span class="n">vqc_to_originir_list</span><span class="p">(</span><span class="n">qunatum_model</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyqpanda</span><span class="w"> </span><span class="kn">import</span> <span class="n">CPUQVM</span><span class="p">,</span><span class="n">convert_originir_str_to_qprog</span><span class="p">,</span><span class="n">convert_qprog_to_originir</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">ll</span> <span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

    <span class="n">machine</span> <span class="o">=</span> <span class="n">CPUQVM</span><span class="p">()</span>
    <span class="n">machine</span><span class="o">.</span><span class="n">init_qvm</span><span class="p">()</span>
    <span class="n">prog</span><span class="p">,</span> <span class="n">qv</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">convert_originir_str_to_qprog</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">machine</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">machine</span><span class="o">.</span><span class="n">prob_run_dict</span><span class="p">(</span><span class="n">prog</span><span class="p">,</span><span class="n">qv</span><span class="p">))</span>

<span class="c1"># QINIT 6</span>
<span class="c1"># CREG 6</span>
<span class="c1"># I q[3]</span>
<span class="c1"># S q[3]</span>
<span class="c1"># SWAP q[2],q[3]</span>
<span class="c1"># CZ q[2],q[3]</span>
<span class="c1"># X q[3]</span>
<span class="c1"># X1 q[3]</span>
<span class="c1"># Y q[3]</span>
<span class="c1"># Y1 q[3]</span>
<span class="c1"># Z q[3]</span>
<span class="c1"># Z1 q[3]</span>
<span class="c1"># RZZ q[2],q[3],(4.484121322631836)</span>
<span class="c1"># RXX q[2],q[3],(5.302337169647217)</span>
<span class="c1"># RYY q[2],q[3],(3.470323085784912)</span>
<span class="c1"># RZX q[2],q[3],(0.20000000298023224)</span>
<span class="c1"># CR q[2],q[3],(5.467088222503662)</span>
<span class="c1"># U1 q[2],(6.254805088043213)</span>
<span class="c1"># U2 q[3],(1.261604905128479,0.9901542067527771)</span>
<span class="c1"># U3 q[1],(5.290454387664795,6.182775020599365,1.1797741651535034)</span>
<span class="c1"># RX q[0],(0.10000000149011612)</span>
<span class="c1"># CNOT q[0],q[1]</span>
<span class="c1"># H q[1]</span>
<span class="c1"># ISWAPTHETA q[0],q[2],(0.6857681274414062)</span>
<span class="c1"># RY q[1],(0.20000000298023224)</span>
<span class="c1"># T q[1]</span>
<span class="c1"># RZ q[1],(0.30000001192092896)</span>
<span class="c1"># DAGGER</span>
<span class="c1"># TOFFOLI q[2],q[3],q[4]</span>
<span class="c1"># ENDDAGGER</span>

<span class="c1"># {&#39;000000&#39;: 0.006448949346548678, &#39;000001&#39;: 0.004089870964118778, &#39;000010&#39;: 0.1660891289303212, &#39;000011&#39;: 0.08520414851665635, &#39;000100&#39;: 0.0048503036661063, &#39;000101&#39;: 8.679196482917438e-05, &#39;000110&#39;: 0.14379026566368325, &#39;000111&#39;: 0.0005079553597106437, &#39;001000&#39;: 0.0023774056959510325, &#39;001001&#39;: 0.008241263544544148, &#39;001010&#39;: 0.06122877075562884, &#39;001011&#39;: 0.1984226195587807, &#39;001100&#39;: 0.0, &#39;001101&#39;: 0.0, &#39;001110&#39;: 0.0, &#39;001111&#39;: 0.0, &#39;010000&#39;: 0.0, &#39;010001&#39;: 0.0, &#39;010010&#39;: 0.0, &#39;010011&#39;: 0.0, &#39;010100&#39;: 0.0, &#39;010101&#39;: 0.0, &#39;010110&#39;: 0.0, &#39;010111&#39;: 0.0, &#39;011000&#39;: 0.0, &#39;011001&#39;: 0.0, &#39;011010&#39;: 0.0, &#39;011011&#39;: 0.0, &#39;011100&#39;: 0.011362100696548312, &#39;011101&#39;: 0.00019143557058348747, &#39;011110&#39;: 0.3059886012103368, &#39;011111&#39;: 0.0011203885556518832, &#39;100000&#39;: 0.0, &#39;100001&#39;: 0.0, &#39;100010&#39;: 0.0, &#39;100011&#39;: 0.0, &#39;100100&#39;: 0.0, &#39;100101&#39;: 0.0, &#39;100110&#39;: 0.0, &#39;100111&#39;: 0.0, &#39;101000&#39;: 0.0, &#39;101001&#39;: 0.0, &#39;101010&#39;: 0.0, &#39;101011&#39;: 0.0, &#39;101100&#39;: 0.0, &#39;101101&#39;: 0.0, &#39;101110&#39;: 0.0, &#39;101111&#39;: 0.0, &#39;110000&#39;: 0.0, &#39;110001&#39;: 0.0, &#39;110010&#39;: 0.0, &#39;110011&#39;: 0.0, &#39;110100&#39;: 0.0, &#39;110101&#39;: 0.0, &#39;110110&#39;: 0.0, &#39;110111&#39;: 0.0, &#39;111000&#39;: 0.0, &#39;111001&#39;: 0.0, &#39;111010&#39;: 0.0, &#39;111011&#39;: 0.0, &#39;111100&#39;: 0.0, &#39;111101&#39;: 0.0, &#39;111110&#39;: 0.0, &#39;111111&#39;: 0.0}</span>
<span class="c1"># QINIT 6</span>
<span class="c1"># CREG 6</span>
<span class="c1"># I q[3]</span>
<span class="c1"># S q[3]</span>
<span class="c1"># SWAP q[2],q[3]</span>
<span class="c1"># CZ q[2],q[3]</span>
<span class="c1"># X q[3]</span>
<span class="c1"># X1 q[3]</span>
<span class="c1"># Y q[3]</span>
<span class="c1"># Y1 q[3]</span>
<span class="c1"># Z q[3]</span>
<span class="c1"># Z1 q[3]</span>
<span class="c1"># RZZ q[2],q[3],(4.484121322631836)</span>
<span class="c1"># RXX q[2],q[3],(5.302337169647217)</span>
<span class="c1"># RYY q[2],q[3],(3.470323085784912)</span>
<span class="c1"># RZX q[2],q[3],(0.20000000298023224)</span>
<span class="c1"># CR q[2],q[3],(5.467088222503662)</span>
<span class="c1"># U1 q[2],(6.254805088043213)</span>
<span class="c1"># U2 q[3],(1.261604905128479,0.9901542067527771)</span>
<span class="c1"># U3 q[1],(5.290454387664795,6.182775020599365,1.1797741651535034)</span>
<span class="c1"># RX q[0],(0.10000000149011612)</span>
<span class="c1"># CNOT q[0],q[1]</span>
<span class="c1"># H q[1]</span>
<span class="c1"># ISWAPTHETA q[0],q[2],(0.6857681274414062)</span>
<span class="c1"># RY q[1],(0.20000000298023224)</span>
<span class="c1"># T q[1]</span>
<span class="c1"># RZ q[1],(0.30000001192092896)</span>
<span class="c1"># DAGGER</span>
<span class="c1"># TOFFOLI q[2],q[3],q[4]</span>
<span class="c1"># ENDDAGGER</span>

<span class="c1"># {&#39;000000&#39;: 0.006448949346548678, &#39;000001&#39;: 0.004089870964118778, &#39;000010&#39;: 0.1660891289303212, &#39;000011&#39;: 0.08520414851665635, &#39;000100&#39;: 0.0048503036661063, &#39;000101&#39;: 8.679196482917438e-05, &#39;000110&#39;: 0.14379026566368325, &#39;000111&#39;: 0.0005079553597106437, &#39;001000&#39;: 0.0023774056959510325, &#39;001001&#39;: 0.008241263544544148, &#39;001010&#39;: 0.06122877075562884, &#39;001011&#39;: 0.1984226195587807, &#39;001100&#39;: 0.0, &#39;001101&#39;: 0.0, &#39;001110&#39;: 0.0, &#39;001111&#39;: 0.0, &#39;010000&#39;: 0.0, &#39;010001&#39;: 0.0, &#39;010010&#39;: 0.0, &#39;010011&#39;: 0.0, &#39;010100&#39;: 0.0, &#39;010101&#39;: 0.0, &#39;010110&#39;: 0.0, &#39;010111&#39;: 0.0, &#39;011000&#39;: 0.0, &#39;011001&#39;: 0.0, &#39;011010&#39;: 0.0, &#39;011011&#39;: 0.0, &#39;011100&#39;: 0.011362100696548312, &#39;011101&#39;: 0.00019143557058348747, &#39;011110&#39;: 0.3059886012103368, &#39;011111&#39;: 0.0011203885556518832, &#39;100000&#39;: 0.0, &#39;100001&#39;: 0.0, &#39;100010&#39;: 0.0, &#39;100011&#39;: 0.0, &#39;100100&#39;: 0.0, &#39;100101&#39;: 0.0, &#39;100110&#39;: 0.0, &#39;100111&#39;: 0.0, &#39;101000&#39;: 0.0, &#39;101001&#39;: 0.0, &#39;101010&#39;: 0.0, &#39;101011&#39;: 0.0, &#39;101100&#39;: 0.0, &#39;101101&#39;: 0.0, &#39;101110&#39;: 0.0, &#39;101111&#39;: 0.0, &#39;110000&#39;: 0.0, &#39;110001&#39;: 0.0, &#39;110010&#39;: 0.0, &#39;110011&#39;: 0.0, &#39;110100&#39;: 0.0, &#39;110101&#39;: 0.0, &#39;110110&#39;: 0.0, &#39;110111&#39;: 0.0, &#39;111000&#39;: 0.0, &#39;111001&#39;: 0.0, &#39;111010&#39;: 0.0, &#39;111011&#39;: 0.0, &#39;111100&#39;: 0.0, &#39;111101&#39;: 0.0, &#39;111110&#39;: 0.0, &#39;111111&#39;: 0.0}</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="originir-to-vqc">
<h3>originir_to_vqc<a class="headerlink" href="#originir-to-vqc" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.originir_to_vqc">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">originir_to_vqc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">originir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'code_tmp.py'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.originir_to_vqc" title="Link to this definition">¶</a></dt>
<dd><p>将 originIR 解析为 vqc 模型代码。
代码创建一个没有 <cite>Measure</cite> 的变分量子线路 <cite>pyvqnet.nn.Module</cite> ,返回是量子态的态矢形式,如 [b,2,…,2]。
该函数将在“./origin_ir_gen_code/” + tmp +“.py”中生成一个定义对应VQNet模型的代码文件。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>originir</strong> – 原始IR。</p></li>
<li><p><strong>tmp</strong> – 代码文件名,默认 <code class="docutils literal notranslate"><span class="pre">code_tmp.py</span></code>。</p></li>
<li><p><strong>verbose</strong> – 如果显示生成代码,默认 = False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>生成可运行代码。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">originir_to_vqc</span>
<span class="n">ss</span> <span class="o">=</span> <span class="s2">&quot;QINIT 3</span><span class="se">\n</span><span class="s2">CREG 3</span><span class="se">\n</span><span class="s2">H q[1]&quot;</span>

<span class="n">Z</span> <span class="o">=</span> <span class="n">originir_to_vqc</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">exec</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span><span class="n">Exported_Model</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># from pyvqnet.nn import Module</span>
<span class="c1"># from pyvqnet.tensor import QTensor</span>
<span class="c1"># from pyvqnet.qnn.vqc import *</span>
<span class="c1"># class Exported_Model(Module):</span>
<span class="c1">#         def __init__(self, name=&quot;&quot;):</span>
<span class="c1">#                 super().__init__(name)</span>

<span class="c1">#                 self.q_machine = QMachine(num_wires=3)</span>
<span class="c1">#                 self.H_0 = Hadamard(wires=1, use_dagger = False)</span>

<span class="c1">#         def forward(self, x, *args, **kwargs):</span>
<span class="c1">#                 x = self.H_0(q_machine=self.q_machine)</span>
<span class="c1">#                 return self.q_machine.states</span>

<span class="c1"># [[[[0.7071068+0.j 0.       +0.j]</span>
<span class="c1">#    [0.7071068+0.j 0.       +0.j]]</span>

<span class="c1">#   [[0.       +0.j 0.       +0.j]</span>
<span class="c1">#    [0.       +0.j 0.       +0.j]]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="model-summary">
<h3>model_summary<a class="headerlink" href="#model-summary" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.model_summary">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.</span></span><span class="sig-name descname"><span class="pre">model_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vqc_module</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.model_summary" title="Link to this definition">¶</a></dt>
<dd><p>打印在 vqc_module 中注册的经典层和量子门运算符的信息。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vqc_module</strong> – vqc 模块</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>摘要字符串</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">RX</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">CNOT</span><span class="p">,</span> <span class="n">PauliX</span><span class="p">,</span> <span class="n">qmatrix</span><span class="p">,</span> <span class="n">PauliZ</span><span class="p">,</span><span class="n">MeasureAll</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span><span class="p">,</span> <span class="n">tensor</span><span class="p">,</span><span class="n">kcomplex64</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.nn</span><span class="w"> </span><span class="kn">import</span> <span class="n">LSTM</span><span class="p">,</span><span class="n">Linear</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">model_summary</span>
<span class="k">class</span><span class="w"> </span><span class="nc">QModel</span><span class="p">(</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_wires</span> <span class="o">=</span> <span class="n">num_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rx_layer1</span> <span class="o">=</span> <span class="n">RX</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">init_params</span><span class="o">=</span><span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ry_layer2</span> <span class="o">=</span> <span class="n">RY</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                            <span class="n">init_params</span><span class="o">=</span><span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlayer</span> <span class="o">=</span> <span class="n">PauliX</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnot</span> <span class="o">=</span> <span class="n">CNOT</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span> <span class="o">=</span> <span class="n">PauliZ</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear</span> <span class="o">=</span> <span class="n">Linear</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lstm</span> <span class="o">=</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">QModel</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">kcomplex64</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">model_summary</span><span class="p">(</span><span class="n">Z</span><span class="p">))</span>
<span class="c1"># ###################QModel Summary#######################</span>

<span class="c1"># classic layers: {&#39;Linear&#39;: 1, &#39;LSTM&#39;: 1}</span>
<span class="c1"># total classic parameters: 650</span>

<span class="c1"># =========================================</span>
<span class="c1"># qubits num: 4</span>
<span class="c1"># gates: {&#39;RX&#39;: 1, &#39;RY&#39;: 1, &#39;PauliX&#39;: 1, &#39;CNOT&#39;: 1}</span>
<span class="c1"># total quantum gates: 4</span>
<span class="c1"># total quantum parameter gates: 2</span>
<span class="c1"># total quantum parameters: 2</span>
<span class="c1"># #########################################################</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="qng">
<h3>QNG<a class="headerlink" href="#qng" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.qng.QNG">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.qng.</span></span><span class="sig-name descname"><span class="pre">QNG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.qng.QNG" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://arxiv.org/abs/1909.02108">量子自然梯度法(Quantum Nature Gradient)</a> 借鉴经典自然梯度法的概念 <a class="reference external" href="https://www.mitpressjournals.org/doi/abs/10.1162/089976698300017746">Amari (1998)</a> ,
我们改为将优化问题视为给定输入的可能输出值的概率分布(即,最大似然估计),则更好的方法是在分布
空间中执行梯度下降,它相对于参数化是无量纲和不变的. 因此,无论参数化如何,每个优化步骤总是会为每个参数选择最佳步长。
在量子机器学习任务中,量子态空间拥有一个独特的不变度量张量,称为 Fubini-Study 度量张量 <span class="math notranslate nohighlight">\(g_{ij}\)</span>。
该张量将量子线路参数空间中的最速下降转换为分布空间中的最速下降。
量子自然梯度的公式如下:</p>
<div class="math notranslate nohighlight">
\[\theta_{t+1} = \theta_t - \eta g^{+}(\theta_t)\nabla \mathcal{L}(\theta),\]</div>
<p>其中 <span class="math notranslate nohighlight">\(g^{+}\)</span> 是伪逆。</p>
<p><code class="docutils literal notranslate"><span class="pre">wrapper_calculate_qng</span></code> 是需要加到待计算量子自然梯度的模型的forward函数的装饰器。仅对模型注册的 <cite>Parameter</cite> 类型的参数优化。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qmodel</strong> – 量子变分线路模型,需要使用 <cite>wrapper_calculate_qng</cite> 作为forward函数的装饰器。</p></li>
<li><p><strong>stepsize</strong> – 梯度下降法的步长,默认0.01。</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>仅在非批处理数据上进行了测试。
仅支持纯变分量子电路。
step() 将更新输入和参数的梯度。
step() 仅会更新模型参数的数值。</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">RX</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">RZ</span><span class="p">,</span> <span class="n">CNOT</span><span class="p">,</span> <span class="n">rz</span><span class="p">,</span> <span class="n">PauliX</span><span class="p">,</span> <span class="n">qmatrix</span><span class="p">,</span> <span class="n">PauliZ</span><span class="p">,</span> <span class="n">Probability</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">MeasureAll</span><span class="p">,</span> <span class="n">U2</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span><span class="p">,</span> <span class="n">tensor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">wrapper_calculate_qng</span>

<span class="k">class</span><span class="w"> </span><span class="nc">QModel</span><span class="p">(</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_wires</span> <span class="o">=</span> <span class="n">num_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer1</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer2</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u2_layer1</span> <span class="o">=</span> <span class="n">U2</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l_train1</span> <span class="o">=</span> <span class="n">RY</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l_train1</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">init_from_tensor</span><span class="p">(</span>
            <span class="n">QTensor</span><span class="p">([</span><span class="mi">333</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kfloat32</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l_train2</span> <span class="o">=</span> <span class="n">RX</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l_train2</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">init_from_tensor</span><span class="p">(</span>
            <span class="n">QTensor</span><span class="p">([</span><span class="mi">4444</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kfloat32</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlayer</span> <span class="o">=</span> <span class="n">PauliX</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnot01</span> <span class="o">=</span> <span class="n">CNOT</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnot12</span> <span class="o">=</span> <span class="n">CNOT</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Y0&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

    <span class="nd">@wrapper_calculate_qng</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">7</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer1</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer2</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">u2_layer1</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>  <span class="c1">#</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cnot01</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnot12</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">7</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">l_train1</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l_train2</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="c1">#rx(q_machine=self.qm, wires=2, params=x[:, [3]])</span>
        <span class="n">rz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
        <span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">7</span><span class="p">)</span>
        <span class="n">rz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cnot01</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnot12</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="n">rlt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rlt</span>


<span class="n">qmodel</span> <span class="o">=</span> <span class="n">QModel</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex64</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">([[</span><span class="mf">1111.0</span><span class="p">,</span> <span class="mi">2222</span><span class="p">,</span> <span class="mi">444</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">666</span><span class="p">]])</span>

<span class="n">qng</span> <span class="o">=</span> <span class="n">pyvqnet</span><span class="o">.</span><span class="n">qnn</span><span class="o">.</span><span class="n">vqc</span><span class="o">.</span><span class="n">QNG</span><span class="p">(</span><span class="n">qmodel</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">qng</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">qmodel</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
<span class="c1">#[[[333.0084]], [[4443.9985]]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="wrapper-single-qubit-op-fuse">
<h3>wrapper_single_qubit_op_fuse<a class="headerlink" href="#wrapper-single-qubit-op-fuse" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.wrapper_single_qubit_op_fuse">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">wrapper_single_qubit_op_fuse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.wrapper_single_qubit_op_fuse" title="Link to this definition">¶</a></dt>
<dd><p>一个用于将单比特运算融合到 Rot 运算中的装饰器。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>f 是模块的前向函数,需要运行一次模型的前向函数才能生效。
此处定义的模型继承自 <code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.QModule</span></code>,该类是 <cite>pyvqnet.nn.Module</cite> 的子类。</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">Operation</span><span class="p">,</span> <span class="n">apply_unitary_bmm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">kcomplex128</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">adjoint</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">single_qubit_ops_fuse</span><span class="p">,</span> <span class="n">wrapper_single_qubit_op_fuse</span><span class="p">,</span> <span class="n">QModule</span><span class="p">,</span><span class="n">op_history_summary</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">RX</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">CNOT</span><span class="p">,</span> <span class="n">PauliX</span><span class="p">,</span> <span class="n">qmatrix</span><span class="p">,</span> <span class="n">PauliZ</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">MeasureAll</span><span class="p">,</span> <span class="n">RZ</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span><span class="p">,</span> <span class="n">tensor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">set_random_seed</span>


<span class="n">set_random_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">QModel</span><span class="p">(</span><span class="n">QModule</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_wires</span> <span class="o">=</span> <span class="n">num_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rx_layer</span> <span class="o">=</span> <span class="n">RX</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ry_layer</span> <span class="o">=</span> <span class="n">RY</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer2</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tlayer</span> <span class="o">=</span> <span class="n">T</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnot</span> <span class="o">=</span> <span class="n">CNOT</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;wires&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s1">&#39;observables&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
            <span class="s1">&#39;coefficient&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">})</span>

    <span class="nd">@wrapper_single_qubit_op_fuse</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rx_layer</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ry_layer</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tlayer</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz_layer2</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]],</span> <span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="n">rlt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rlt</span>

<span class="n">input_x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]],</span>
                        <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kfloat64</span><span class="p">)</span>

<span class="n">input_xt</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">input_x</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">input_xt</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">qunatum_model</span> <span class="o">=</span> <span class="n">QModel</span><span class="p">(</span><span class="n">num_wires</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex128</span><span class="p">)</span>
<span class="n">batch_y</span> <span class="o">=</span> <span class="n">qunatum_model</span><span class="p">(</span><span class="n">input_xt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">op_history_summary</span><span class="p">(</span><span class="n">qunatum_model</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">op_history</span><span class="p">))</span>


<span class="c1"># ###################Summary#######################</span>
<span class="c1"># qubits num: 2</span>
<span class="c1"># gates: {&#39;rot&#39;: 2, &#39;cnot&#39;: 1}</span>
<span class="c1"># total gates: 3</span>
<span class="c1"># total parameter gates: 2</span>
<span class="c1"># total parameters: 6</span>
<span class="c1"># #################################################</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="wrapper-commute-controlled">
<h3>wrapper_commute_controlled<a class="headerlink" href="#wrapper-commute-controlled" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.wrapper_commute_controlled">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">wrapper_commute_controlled</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'right'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.wrapper_commute_controlled" title="Link to this definition">¶</a></dt>
<dd><p>装饰器用于进行受控门交换
这是一个量子变换,用于将可交换的门移动到受控操作的控制比特和目标比特之前。
控制比特两侧的对角门不会影响受控门的结果；因此,我们可以将所有作用在第一个比特上的单比特门一起推到右边(如果需要,可以进行融合)。
类似地,X 门与 CNOT 和 Toffoli 的目标比特可交换(PauliY 与 CRY 也是如此)。
我们可以使用此变换将单比特门尽可能推到受控操作的深处。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>f 是模块的前向函数,需要运行一次模型的前向函数才能生效。
此处定义的模型继承自 <code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.QModule</span></code>,该类是 <cite>pyvqnet.nn.Module</cite> 的子类。</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> – 前向函数。</p></li>
<li><p><strong>direction</strong> – 移动单比特门的方向,可选值为 “left” 或 “right”,默认为 “right”。</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">kcomplex128</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">adjoint</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">wrapper_commute_controlled</span><span class="p">,</span> <span class="n">pauliy</span><span class="p">,</span> <span class="n">QModule</span><span class="p">,</span><span class="n">op_history_summary</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">RX</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">CNOT</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">CRY</span><span class="p">,</span> <span class="n">PauliZ</span><span class="p">,</span> <span class="n">PauliX</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">MeasureAll</span><span class="p">,</span> <span class="n">RZ</span><span class="p">,</span> <span class="n">CZ</span><span class="p">,</span> <span class="n">PhaseShift</span><span class="p">,</span> <span class="n">Toffoli</span><span class="p">,</span> <span class="n">cnot</span><span class="p">,</span> <span class="n">cry</span><span class="p">,</span> <span class="n">toffoli</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span><span class="p">,</span> <span class="n">tensor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">set_random_seed</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn</span><span class="w"> </span><span class="kn">import</span> <span class="n">expval</span><span class="p">,</span> <span class="n">QuantumLayerV2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">partial</span>
<span class="n">set_random_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">QModel</span><span class="p">(</span><span class="n">QModule</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_wires</span> <span class="o">=</span> <span class="n">num_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cz</span> <span class="o">=</span> <span class="n">CZ</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">paulix</span> <span class="o">=</span> <span class="n">PauliX</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ps</span> <span class="o">=</span> <span class="n">PhaseShift</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;wires&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;observables&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span>
            <span class="s1">&#39;coefficient&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">})</span>

    <span class="nd">@partial</span><span class="p">(</span><span class="n">wrapper_commute_controlled</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">paulix</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">pauliy</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">cry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ps</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="n">toffoli</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="n">rlt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rlt</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tensor</span>
<span class="n">input_x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]],</span>
                            <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kfloat64</span><span class="p">)</span>

<span class="n">input_xt</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">input_x</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">input_xt</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">qunatum_model</span> <span class="o">=</span> <span class="n">QModel</span><span class="p">(</span><span class="n">num_wires</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex128</span><span class="p">)</span>

<span class="n">batch_y</span> <span class="o">=</span> <span class="n">qunatum_model</span><span class="p">(</span><span class="n">input_xt</span><span class="p">)</span>
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">qunatum_model</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">op_history</span><span class="p">:</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
    <span class="n">wires</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;wires&quot;</span><span class="p">]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;name: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> wires: </span><span class="si">{</span><span class="n">wires</span><span class="si">}</span><span class="s2">, params = </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="c1"># name: s wires: (0,), params = None</span>
<span class="c1"># name: phaseshift wires: (0,), params = [[4.744782]]</span>
<span class="c1"># name: t wires: (0,), params = None</span>
<span class="c1"># name: cz wires: (0, 2), params = None</span>
<span class="c1"># name: paulix wires: (2,), params = None</span>
<span class="c1"># name: cnot wires: (0, 1), params = None</span>
<span class="c1"># name: pauliy wires: (1,), params = None</span>
<span class="c1"># name: cry wires: (0, 1), params = [[0.5]]</span>
<span class="c1"># name: rz wires: (1,), params = [[4.7447823]]</span>
<span class="c1"># name: toffoli wires: (0, 1, 2), params = None</span>
<span class="c1"># name: MeasureAll wires: [0], params = None</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="wrapper-merge-rotations">
<h3>wrapper_merge_rotations<a class="headerlink" href="#wrapper-merge-rotations" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.wrapper_merge_rotations">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">wrapper_merge_rotations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.wrapper_merge_rotations" title="Link to this definition">¶</a></dt>
<dd><p>合并相同类型的旋转门的装饰器,包括 “rx”、”ry”、”rz”、”phaseshift”、”crx”、”cry”、”crz”、”controlledphaseshift”、”isingxx”、
“isingyy”、”isingzz”、”rot”。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>f 是模块的前向函数,需要运行一次模型的前向函数才能生效。
此处定义的模型继承自 <code class="docutils literal notranslate"><span class="pre">pyvqnet.qnn.vqc.QModule</span></code>,该类是 <cite>pyvqnet.nn.Module</cite> 的子类。</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f</strong> – 前向函数。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span><span class="n">op_history_summary</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">kcomplex128</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">adjoint</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>


<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QModule</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span><span class="p">,</span> <span class="n">tensor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">set_random_seed</span>

<span class="n">set_random_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">QModel</span><span class="p">(</span><span class="n">QModule</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_wires</span> <span class="o">=</span> <span class="n">num_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;wires&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;observables&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span>
            <span class="s1">&#39;coefficient&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">})</span>

    <span class="nd">@wrapper_merge_rotations</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">rx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">))</span>
        <span class="n">rx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">))</span>
        <span class="n">rx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">))</span>
        <span class="n">rot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">),</span> <span class="n">use_dagger</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">rot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">),</span> <span class="n">use_dagger</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">isingxy</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">isingxy</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">))</span>
        <span class="n">hadamard</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
        <span class="n">crz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=-</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>


<span class="n">input_x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kfloat64</span><span class="p">)</span>

<span class="n">input_x</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">qunatum_model</span> <span class="o">=</span> <span class="n">QModel</span><span class="p">(</span><span class="n">num_wires</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex128</span><span class="p">)</span>
<span class="n">qunatum_model</span><span class="o">.</span><span class="n">use_merge_rotations</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">batch_y</span> <span class="o">=</span> <span class="n">qunatum_model</span><span class="p">(</span><span class="n">input_x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">op_history_summary</span><span class="p">(</span><span class="n">qunatum_model</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">op_history</span><span class="p">))</span>
<span class="c1"># ###################Summary#######################</span>
<span class="c1"># qubits num: 3</span>
<span class="c1"># gates: {&#39;rx&#39;: 1, &#39;rot&#39;: 1, &#39;isingxy&#39;: 2, &#39;cnot&#39;: 1, &#39;hadamard&#39;: 1, &#39;crz&#39;: 1}</span>
<span class="c1"># total gates: 7</span>
<span class="c1"># total parameter gates: 5</span>
<span class="c1"># total parameters: 7</span>
<span class="c1"># #################################################</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="wrapper-compile">
<h3>wrapper_compile<a class="headerlink" href="#wrapper-compile" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyvqnet.qnn.vqc.wrapper_compile">
<span class="sig-prename descclassname"><span class="pre">pyvqnet.qnn.vqc.</span></span><span class="sig-name descname"><span class="pre">wrapper_compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compile_rules</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[commute_controlled_right,</span> <span class="pre">merge_rotations,</span> <span class="pre">single_qubit_ops_fuse]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.qnn.vqc.wrapper_compile" title="Link to this definition">¶</a></dt>
<dd><p>使用编译规则来优化 QModule 的电路。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>f 是模块的前向函数,需要运行一次模型的前向函数才能生效。
此处定义的模型继承自 <cite>pyvqnet.qnn.vqc.QModule</cite>,该类是 <cite>pyvqnet.nn.Module</cite> 的子类。</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f</strong> – 前向函数。</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">partial</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">op_history_summary</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QModule</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">wrapper_compile</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">pauliy</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.qnn.vqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMachine</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span><span class="n">rz</span><span class="p">,</span> <span class="n">ControlledPhaseShift</span><span class="p">,</span> \
    <span class="n">rx</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">isingxy</span><span class="p">,</span><span class="n">CSWAP</span><span class="p">,</span> <span class="n">PauliX</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">MeasureAll</span><span class="p">,</span> <span class="n">RZ</span><span class="p">,</span> <span class="n">CZ</span><span class="p">,</span> <span class="n">PhaseShift</span><span class="p">,</span> <span class="n">u3</span><span class="p">,</span> <span class="n">cnot</span><span class="p">,</span> <span class="n">cry</span><span class="p">,</span> <span class="n">toffoli</span><span class="p">,</span> <span class="n">cy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTensor</span><span class="p">,</span> <span class="n">tensor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet</span>

<span class="k">class</span><span class="w"> </span><span class="nc">QModel_before</span><span class="p">(</span><span class="n">QModule</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QModel_before</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_wires</span> <span class="o">=</span> <span class="n">num_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">set_save_op_history_flag</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cswap</span> <span class="o">=</span> <span class="n">CSWAP</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cz</span> <span class="o">=</span> <span class="n">CZ</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">paulix</span> <span class="o">=</span> <span class="n">PauliX</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ps</span> <span class="o">=</span> <span class="n">PhaseShift</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cps</span> <span class="o">=</span> <span class="n">ControlledPhaseShift</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                        <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                        <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                                        <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;wires&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;observables&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span>
            <span class="s1">&#39;coefficient&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">})</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">paulix</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="n">rx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">rz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,[</span><span class="mi">2</span><span class="p">]])</span>
        <span class="n">rot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">),</span> <span class="n">use_dagger</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">rot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">),</span> <span class="n">use_dagger</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">isingxy</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">u3</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cswap</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">params</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">pauliy</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">cry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ps</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cps</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">params</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">rz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">params</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,[</span><span class="mi">2</span><span class="p">]])</span>
        <span class="n">toffoli</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>

        <span class="n">cy</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>

        <span class="n">rlt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rlt</span>
<span class="k">class</span><span class="w"> </span><span class="nc">QModel</span><span class="p">(</span><span class="n">QModule</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_wires</span> <span class="o">=</span> <span class="n">num_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span> <span class="o">=</span> <span class="n">QMachine</span><span class="p">(</span><span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cswap</span> <span class="o">=</span> <span class="n">CSWAP</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cz</span> <span class="o">=</span> <span class="n">CZ</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">paulix</span> <span class="o">=</span> <span class="n">PauliX</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ps</span> <span class="o">=</span> <span class="n">PhaseShift</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cps</span> <span class="o">=</span> <span class="n">ControlledPhaseShift</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                        <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                        <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                                        <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz</span> <span class="o">=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="n">MeasureAll</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;wires&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;observables&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span>
            <span class="s1">&#39;coefficient&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">})</span>

    <span class="nd">@partial</span><span class="p">(</span><span class="n">wrapper_compile</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">reset_states</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">paulix</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="n">rx</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">rz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,[</span><span class="mi">2</span><span class="p">]])</span>
        <span class="n">rot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">),</span> <span class="n">use_dagger</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">rot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">),</span> <span class="n">use_dagger</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">isingxy</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">u3</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cswap</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="n">cnot</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">params</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">pauliy</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">cry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ps</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cps</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>
        <span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">params</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">rz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">params</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,[</span><span class="mi">2</span><span class="p">]])</span>
        <span class="n">toffoli</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>

        <span class="n">cy</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">ry</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">,</span><span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rz</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>

        <span class="n">rlt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_machine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">qm</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rlt</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvqnet.tensor</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tensor</span>
<span class="n">input_x</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">QTensor</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]],</span>
                            <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kfloat64</span><span class="p">)</span>

<span class="n">input_x</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">num_wires</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">qunatum_model</span> <span class="o">=</span> <span class="n">QModel</span><span class="p">(</span><span class="n">num_wires</span><span class="o">=</span><span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex128</span><span class="p">)</span>
<span class="n">qunatum_model_before</span> <span class="o">=</span> <span class="n">QModel_before</span><span class="p">(</span><span class="n">num_wires</span><span class="o">=</span><span class="n">num_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pyvqnet</span><span class="o">.</span><span class="n">kcomplex128</span><span class="p">)</span>

<span class="n">batch_y</span> <span class="o">=</span> <span class="n">qunatum_model</span><span class="p">(</span><span class="n">input_x</span><span class="p">)</span>
<span class="n">batch_y</span> <span class="o">=</span> <span class="n">qunatum_model_before</span><span class="p">(</span><span class="n">input_x</span><span class="p">)</span>

<span class="n">flatten_oph_names</span> <span class="o">=</span> <span class="p">[]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;before&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">op_history_summary</span><span class="p">(</span><span class="n">qunatum_model_before</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">op_history</span><span class="p">))</span>
<span class="n">flatten_oph_names</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">qunatum_model</span><span class="o">.</span><span class="n">compiled_op_historys</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;compile&quot;</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">oph</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;op_history&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">oph</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                <span class="n">w</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="s2">&quot;wires&quot;</span><span class="p">]</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span>
                <span class="n">flatten_oph_names</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="n">n</span><span class="p">,</span><span class="s2">&quot;wires&quot;</span><span class="p">:</span><span class="n">w</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;after&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">op_history_summary</span><span class="p">(</span><span class="n">qunatum_model</span><span class="o">.</span><span class="n">qm</span><span class="o">.</span><span class="n">op_history</span><span class="p">))</span>


<span class="c1"># ###################Summary#######################</span>
<span class="c1"># qubits num: 3</span>
<span class="c1"># gates: {&#39;cz&#39;: 1, &#39;paulix&#39;: 1, &#39;rx&#39;: 1, &#39;ry&#39;: 4, &#39;rz&#39;: 3, &#39;rot&#39;: 2, &#39;isingxy&#39;: 1, &#39;u3&#39;: 1, &#39;s&#39;: 1, &#39;cswap&#39;: 1, &#39;cnot&#39;: 1, &#39;pauliy&#39;: 1, &#39;cry&#39;: 1, &#39;phaseshift&#39;: 1, &#39;controlledphaseshift&#39;: 1, &#39;toffoli&#39;: 1, &#39;t&#39;: 1, &#39;cy&#39;: 1}</span>
<span class="c1"># total gates: 24</span>
<span class="c1"># total parameter gates: 15</span>
<span class="c1"># total parameters: 21</span>
<span class="c1"># #################################################</span>

<span class="c1"># after</span>


<span class="c1"># ###################Summary#######################</span>
<span class="c1"># qubits num: 3</span>
<span class="c1"># gates: {&#39;cz&#39;: 1, &#39;rot&#39;: 7, &#39;isingxy&#39;: 1, &#39;u3&#39;: 1, &#39;cswap&#39;: 1, &#39;cnot&#39;: 1, &#39;cry&#39;: 1, &#39;controlledphaseshift&#39;: 1, &#39;toffoli&#39;: 1, &#39;cy&#39;: 1}</span>
<span class="c1"># total gates: 16</span>
<span class="c1"># total parameter gates: 11</span>
<span class="c1"># total parameters: 27</span>
<span class="c1"># #################################################</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="qnn_pq3.html" class="btn btn-neutral float-left" title="使用pyQPanda3量子机器学习模块" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="llm.html" class="btn btn-neutral float-right" title="量子大模型微调示例" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Original Quantum.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>